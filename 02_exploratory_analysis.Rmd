---
title: 'Risk Perception: Threshold 3 US + DE'
output:
  html_document: default
  pdf_document: default
date: "2025-03-16"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Used packages
```{r, results = "hide"}
library(tidyverse)
library(readxl)
library(visdat)
install.packages("XLConnect")
install.packages("car")
library(car)
library(XLConnect)
library(knitr)
library(viridis)
library(lme4)
install.packages("lmerTest")
library(lmerTest)
```

## General Information

Now, all the data has been compiled into a single Excel file, with the various thresholds available as individual sheets.
For my analysis, I will focus on data from participants in the US and Germany.
My goal is to examine the influence of political orientation on risk perception.

## Threshold 3 Minutes

First I will look at the data with Threshold 3 minutes.

## Reading in Data

```{r}
df_3_tresh <- read_excel("C:\\Users\\vanes\\OneDrive\\Desktop\\Master Psychologie\\4. Semester\\Masterarbeit\\Datafiles\\Dataset mit unterschiedlichen treshholds\\newest_dat_file.xls", sheet = 3)
```


# Overview of the US and Germany Sample

US: 1815
DE: 1852

Before starting the data analysis, data cleaning will be performed. 
Initially, the US sample consisted of 1,815 participants, while the German sample included 1,852 participants. 
A total of 3,667 participants from both countries.

```{r}
df_3_tresh %>%
  group_by(Country) %>%
  summarize(Number_of_Participants = n()) %>%
  ggplot(aes(x = Country, y = Number_of_Participants, fill = Country)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = Number_of_Participants), vjust = -0.5, position = position_dodge(width = 0.9)) +
  labs(title = "Number of Participants (Threshold: 3 Minutes)",
       x = "Country", 
       y = "Number of Participants") +
  theme_minimal() +
 scale_fill_manual(values = c("#F8766D", "#00BFC4"))
```
## Calculation of Survey Completion Time and Interquartile range (IQR) before and after further Data Cleaning

Before further Data Cleaning:

In this dataset, a minimum threshold of 3 minutes was set, meaning completion times range from 3 to 14 minutes. The median survey completion time was 5.31 minutes in Germany and 5.69 minutes in the United States.

To assess variability, the interquartile range (IQR) was 2.90 minutes in Germany and 2.86 minutes in the United States, suggesting that most participants completed the survey within a typical range of 4.14 to 7.04 minutes (Germany) and 4.46 to 7.32 minutes (USA). The overall patterns in completion times are similar across both countries. However, the maximum completion time of 14.3 minutes exceeds the upper IQR boundary of 11.38 minutes, indicating that a subset of participants took significantly longer.

```{r}
# Calculate survey completion time statistics separately for USA and Germany (before Data Cleaning)
survey_time_by_country_before <- df_3_tresh %>%
  group_by(Country) %>%  # Group by country
  summarize(
    mean_time = mean(minutes_interviewtime, na.rm = TRUE),    # Mean survey time
    median_time = median(minutes_interviewtime, na.rm = TRUE), # Median survey time
    sd_time = sd(minutes_interviewtime, na.rm = TRUE),        # Standard deviation
    min_time = min(minutes_interviewtime, na.rm = TRUE),      # Minimum survey time
    max_time = max(minutes_interviewtime, na.rm = TRUE)       # Maximum survey time
  )

# Print the results
print(survey_time_by_country_before)

# Calculate survey completion time statistics separately for USA and Germany (after Data Cleaning)
survey_time_by_country_after <- df_3_tresh_cleaned %>%
  group_by(Country_f) %>%  # Group by country
  summarize(
    mean_time = mean(minutes_interviewtime, na.rm = TRUE),    # Mean survey time
    median_time = median(minutes_interviewtime, na.rm = TRUE), # Median survey time
    sd_time = sd(minutes_interviewtime, na.rm = TRUE),        # Standard deviation
    min_time = min(minutes_interviewtime, na.rm = TRUE),      # Minimum survey time
    max_time = max(minutes_interviewtime, na.rm = TRUE)       # Maximum survey time
  )

# Print the results
print(survey_time_by_country_after)

# Interquartile range (IQR) to check for potential outliers (before Data Cleaning)
iqr_time_before <- df_3_tresh %>%
  group_by(Country) %>% 
  summarize(
    Q1 = quantile(minutes_interviewtime, 0.25, na.rm = TRUE),  
    Q3 = quantile(minutes_interviewtime, 0.75, na.rm = TRUE),  
    IQR = Q3 - Q1
  )

print(iqr_time_before)


# Interquartile range (IQR) to check for potential outliers (after Data Cleaning)
iqr_time_after <- df_3_tresh_cleaned %>%
  group_by(Country) %>% 
  summarize(
    Q1 = quantile(minutes_interviewtime, 0.25, na.rm = TRUE),  
    Q3 = quantile(minutes_interviewtime, 0.75, na.rm = TRUE),  
    IQR = Q3 - Q1
  )

print(iqr_time_after)

# Filter participants who took longer than 11.38 minutes
long_time_participants <- df_3_tresh %>%
  filter(minutes_interviewtime > 11.38)

# Count the number of participants per country
long_time_count <- long_time_participants %>%
  group_by(Country) %>%
  summarise(count = n())

# View the results
print(long_time_count)

```

# Data Cleaning: Check Political Scales for Missing Values

Since the focus of my thesis is on participants' political orientation and their risk perception, data cleaning will begin with the two political scales (Liberal-Conservative Scale and Left-Right Wing Scale). The number of missing values for these variables will be examined first.

Only participants who provided complete responses for the political orientation scales were selected to ensure the validity of subsequent analyses. Specifically, participants who did not provide values for both the LibConsPolitValue (Liberal-Conservative Political Value) and LeftRightPolitValue (Left-Right Political Value) were excluded from the dataset.

Before exclusion, the dataset contained:

- 1852 participants from the US
- 1815 participants from Germany

Number of missing political values:

- 163 participants from the US had missing political values and were removed.
- 146 participants from Germany had missing political values and were removed.

After exclusion, the dataset contained:

- 1689 participants from the US
- 1669 participants from Germany

The next dataset includes only participants who provided responses for both political scales, resulting in a sample of 1,689 participants from the US and 1,669 participants from Germany. 
After excluding participants with missing political values, a total of 3,358 participants remained across both countries.
```{r}
# Only filter participants who have completed the political scales
df_3_tresh_cleanedv1 <- df_3_tresh[!is.na(df_3_tresh$LibConsPolitValue) & 
                                 !is.na(df_3_tresh$LeftRightPolitValue), ]

# Check the number of remaining participants
num_remaining_participants <- nrow(df_3_tresh_cleanedv1)
cat("Number of remaining participants after removing those with missing political values: ", num_remaining_participants, "\n")

# Number of missing values in the political scales for US participants
us_missing <- df_3_tresh[df_3_tresh$Country == "US" & 
                         (is.na(df_3_tresh$LibConsPolitValue) | is.na(df_3_tresh$LeftRightPolitValue)), ]
cat("Number of missing political values in the US data: ", nrow(us_missing), "\n")

# Number of missing values in the political scales for DE participants
de_missing <- df_3_tresh[df_3_tresh$Country == "DE" & 
                         (is.na(df_3_tresh$LibConsPolitValue) | is.na(df_3_tresh$LeftRightPolitValue)), ]
cat("Number of missing political values in the DE data: ", nrow(de_missing), "\n")

```

# Check for Missing Values in Demographic Variables: Age, Gender, and Education by Country

Now, an examination will be conducted to check if there are any missing values in the demographic variables such as age, gender, and education.

For Germany, there were no missing values for the age variable, while gender and education both had a small number of missing values, with 2 missing gender entries and 39 missing education entries. Additionally, one participant provided an "other" response for gender, and 39 participants provided "other" responses for education.

In the United States sample, there were no missing values for age, gender, or education. However, there were 2 participants who selected "other" for gender, and 33 participants selected "other" for education

Since the "other" responses for gender did not provide any usable comments, these entries will be removed from the sample.
The responses in the "education other" category included highly specific degrees or courses that are difficult to categorize within the predefined education levels. Therefore, these entries will be excluded as well for further analysis.

So, in total:

Germany: 78 cases are excluded.
United States: 35 cases are excluded.

After excluding participants with missing political values, as well as those excluded due to invalid responses in the "gender" and "education" variables, the final dataset consisted of 1,591 participants from Germany and 1,654 participants from the United States, resulting in a total of 3,245 participants across both countries.

```{r}
# Check for missing values and 'other' entries in 'age', 'gender', and 'education' by country (US vs DE)
missing_and_other_values_by_country <- df_3_tresh_cleanedv1 %>%
  group_by(Country) %>%
  summarise(
    age_missing = sum(is.na(age)),
    gender_missing = sum(is.na(gender)),
    education_missing = sum(is.na(education)),
    gender_other = sum(!is.na(gender) & grepl("other", gender, ignore.case = TRUE)),
    education_other = sum(!is.na(education) & grepl("other", education, ignore.case = TRUE)),
    .groups = 'drop'  # To ungroup after summarization
  )

# Display the summary of missing values and 'other' entries by country
print(missing_and_other_values_by_country)

# Create a new dataset by removing participants with missing values or 'other' entries in 'age', 'gender', and 'education'
df_3_tresh_cleaned <- df_3_tresh_cleanedv1 %>%
  filter(
    # Remove rows where 'age', 'gender', or 'education' are missing
    !is.na(age) & !is.na(gender) & !is.na(education),
    
    # Remove rows where 'gender' or 'education' contain 'other' or similar values
    !grepl("other", gender, ignore.case = TRUE) & !grepl("other", education, ignore.case = TRUE)
  )

# Display the number of remaining participants after filtering
cat("Number of remaining participants after removing missing or 'other' entries: ", nrow(df_3_tresh_cleaned), "\n")

```
# Check for Cases where Participants Rated All 36 Risk Items Identically

This code identifies participants who provided the same rating across all 36 risk items in the dataset.

It was found that 29 participants from Germany and 37 participants from the United States (in total 66 participants) provided identical ratings for all 36 risk items. These participants rated each of the 36 items with the same score, suggesting a pattern of uniform responses across all risk dimensions in the survey.

```{r}
# Check if a participant has rated all 36 questions with the same rating, grouped by country
same_rating_participants_by_country <- df_3_tresh_cleaned %>%
  group_by(Country, id) %>%
  filter(
    # Check if all 36 ratings have the same number across all dimensions
    n_distinct(c(
      VaccinationAffect, VaccinationProbs, VaccinationSever,
      ViralPandemicAffect, ViralPandemicProbs, ViralPandemicSever,
      MentHealthProbAffect, MentHealthProbProbs, MentHealthProbSever,
      SexAssaultAffect, SexAssaultProbs, SexAssaultSever,
      GunViolAffect, GunViolProbs, GunViolSever,
      TerrorismAffect, TerrorismProbs, TerrorismSever,
      ClimateChangeAffect, ClimateChangeProbs, ClimateChangeSever,
      NaturalDisastAffect, NaturalDisastProbs, NaturalDisastSever,
      NuclPowerPlantAffect, NuclPowerPlantProbs, NuclPowerPlantSever,
      IllegImmigratAffect, IllegImmigratProbs, IllegImmigratSever,
      PolitCorruptAffect, PolitCorruptProbs, PolitCorruptSever,
      EconCrisisAffect, EconCrisisProbs, EconCrisisSever
    )) == 1  # Check if only one unique rating exists for all 36 ratings
  ) %>%
  ungroup()

# Count the number of participants who rated all 36 items the same, by country
same_rating_count_by_country <- same_rating_participants_by_country %>%
  group_by(Country) %>%
  summarise(
    num_same_rating_participants = n_distinct(id),
    .groups = 'drop'
  )

# Print the results
print(same_rating_count_by_country)

```
## Gender Distribution Visualization and Description

The gender distribution within the U.S. sample (N = 1,654) was comprised of 942 participants identifying as female (57%), 700 as male (42.3%), 8 as non-binary or gender diverse (0.5%), 5 participants (0.3%) who preferred not to disclose their gender.

The gender distribution within the German sample (N = 1,591) was comprised of 869 participants identifying as female (54.6%), 714 as male (44.9%), 6 as non-binary or gender diverse (0.4%), 1 participant (0.1%) who preferred not to disclose their gender.


```{r}
# Gender distribution for the US
table(df_3_tresh_cleaned$gender[df_3_tresh_cleaned$Country == "US"])

# Gender distribution for Germany
table(df_3_tresh_cleaned$gender[df_3_tresh_cleaned$Country == "DE"])

```

```{r}
# Missing values and specific categories (Non-binary, Other, Prefer not to say) are combined into "Other"
df_3_tresh_cleaned$gender[is.na(df_3_tresh_cleaned$gender) | df_3_tresh_cleaned$gender %in% c("Non-binary / Gender diverse", "Prefer not to say")] <- "Other"

# Create a gender distribution plot for both the US and Germany
ggplot(df_3_tresh_cleaned, aes(x = gender, fill = gender)) +
  geom_bar(stat = "count", position = "dodge") +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5) +
  labs(title = "Gender Distribution Among Participants (Threshold: 3 Minutes)",
       x = "Gender", 
       y = "Number of Participants") +
  scale_fill_manual(values = c("Female" = "salmon", "Male" = "lightblue", "Other" = "lightgreen")) +  # Lightblue for Male, Salmon for Female, Lightgreen for Other
  theme_minimal() +
  theme(legend.position = "none") +  # Remove legend as the labels are already included
  facet_wrap(~ Country) +  # Create separate plots for each country
  ylim(0, 1200)  # Set y-axis limit to 1200
```

## Age Distribution Visualization and Description

- By Country: The average age distribution differs slightly between the two countries. In the German sample (N = 1,591), the mean age is 52.23 years (SD = 16.27, Range: 18–88), while in the U.S. sample (N = 1,654), it is slightly higher at 55.27 years (SD = 17.30, Range: 18–99).

- By Gender: When broken down by gender, the average age of women in Germany is 53.85 years (SD = 15.86), and the average age of men is 50.39 years (SD = 16.53). In the U.S., women are, on average, 55.10 years old (SD = 17.35), while men are 55.92 years old (SD = 17.02).

Participants who identified as “Other” (Non-binary, Prefer not to say) were generally younger in both countries. In Germany, their average age is 37.71 years (SD = 14.50), while in the U.S., it is 33.46 years (SD = 14.86).

```{r, fig.width=9, fig.height=7}
# Histogram of Age Distribution for both US and Germany
ggplot(df_3_tresh_cleaned, aes(x = age)) +
  geom_histogram(binwidth = 5, fill = "darkgreen", color = "black", boundary = 0) + 
  labs(title = "Age Distribution of US and Germany Participants (Threshold: 3 Minutes)", 
       x = "Age (years)", 
       y = "Number of Participants") +
  theme_minimal() +
  scale_x_continuous(breaks = seq(0, 100, by = 10)) +  # X-axis breaks every 10 years
  scale_y_continuous(limits = c(0, 300)) +
  theme(axis.text = element_text(size = 12),
        axis.title = element_text(size = 14)) +
  facet_wrap(~ Country)  # Facet by Country (US vs Germany)

```
# APA Table Sample Germany

```{r}

library(tidyverse)
library(gt)

# Sample-Daten
sample_data <- tibble::tribble(
  ~Gender,            ~n,  ~Age_M, ~Age_SD, ~PolOri_M, ~PolOri_SD,
  "Female",           869, 53.85, 15.86, 5.36, 2.08,
  "Male",             714, 50.39, 16.53, 5.07, 2.06,
  "Non-binary/Other",   7, 37.71, 14.50, 1.86, 3.70
)

# APA-konforme Tabelle mit gt
apa_sample_table <- sample_data %>%
  gt() %>%
  cols_label(
    Gender    = "Gender",
    n         = md("*n*"),
    Age_M     = md("Age *M*"),
    Age_SD    = md("Age *SD*"),
    PolOri_M  = md("Political Orientation *M*"),
    PolOri_SD = md("Political Orientation *SD*")
  ) %>%
  fmt_number(
    columns = c(Age_M, Age_SD, PolOri_M, PolOri_SD),
    decimals = 2
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.font.size = px(18),  # Schriftgrösse
    table.width = pct(80),     
    column_labels.font.weight = "bold",
    table.align = "center"
  )

# Tabelle anzeigen
apa_sample_table

# Tabelle speichern
gtsave(
  apa_sample_table,
  "Table2_Sample_Germany.png"
)
```
# APA Table Sample U.S.

```{r}


# Sample-Daten
sample_data_us <- tibble::tribble(
  ~Gender,            ~n,  ~Age_M, ~Age_SD, ~PolOri_M, ~PolOri_SD,
  "Female",           942, 55.10, 17.35, 5.21, 2.69,
  "Male",             700, 55.92, 17.02, 5.79, 2.63,
  "Non-binary/Other",   13, 33.46, 14.86, 3.85, 2.73
)

# APA-konforme Tabelle mit gt
apa_sample_table_us <- sample_data_us %>%
  gt() %>%
  cols_label(
    Gender    = "Gender",
    n         = md("*n*"),
    Age_M     = md("Age *M*"),
    Age_SD    = md("Age *SD*"),
    PolOri_M  = md("Political Orientation *M*"),
    PolOri_SD = md("Political Orientation *SD*")
  ) %>%
  fmt_number(
    columns = c(Age_M, Age_SD, PolOri_M, PolOri_SD),
    decimals = 2
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.font.size = px(18),  # Schriftgrösse
    table.width = pct(80),     
    column_labels.font.weight = "bold",
    table.align = "center"
  )

# Tabelle anzeigen
apa_sample_table_us

# Tabelle speichern
gtsave(
  apa_sample_table_us,
  "Table2_Sample_USA.png"
)
```
# Threshold Overview Table
```{r}
# Deine Survey-Daten
survey_data <- tibble::tribble(
  ~Threshold,         ~N_GER_USA,          ~Mean,        ~SD,          ~Range,
  "No lower threshold","4056 (2064 / 1992)","5.51 / 5.98","2.46 / 1.67","1.64 - 14.22 / 1.67 - 14.32",
  "≥ 3 minutes",       "3667 (1815 / 1852)","5.92 / 6.24","2.34 / 2.39","3.01 - 14.22 / 3.00 - 14.32",
  "≥ 5 minutes",       "2212 (1030 / 1182)","7.38 / 7.46","2.12 / 2.16","5.00 - 14.22 / 5.00 - 14.32"
)

# APA-konforme Tabelle mit gt
apa_survey_table <- survey_data %>%
  gt() %>%
  cols_label(
    Threshold = "Threshold",
    N_GER_USA = md("*N* (GER / USA)"),
    Mean      = md("*Mean* (min)"),
    SD        = md("*SD*"),
    Range     = "Range (Min-Max)"
  ) %>%
  fmt_number(
    columns = c(Mean, SD),
    decimals = 2
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.font.size = px(18),
    table.width = pct(80),
    column_labels.font.weight = "bold",
    table.align = "center"
  )

# Tabelle anzeigen
apa_survey_table

# Tabelle speichern
gtsave(
  apa_survey_table,
  "Table_Survey_GER_USA.png"
)





# Survey-Daten USA und Germany getrennt
survey_data_blocks <- tibble::tribble(
  ~Threshold,          ~N_GER, ~Mean_GER, ~SD_GER, ~Range_GER, ~N_USA, ~Mean_USA, ~SD_USA, ~Range_USA,
  "No lower threshold", 2064,   5.51,      2.46,    "1.6–14.2", 1992,   5.98,      1.67,    "1.7–14.3",
  "≥ 3 minutes",        1815,   5.92,      2.34,    "3.0–14.2", 1852,   6.24,      2.39,    "3.0–14.3",
  "≥ 5 minutes",        1030,   7.38,      2.12,    "5.0–14.2", 1182,   7.46,      2.16,    "5.0–14.3"
)

# APA-konforme Tabelle mit gt
apa_survey_table_blocks <- survey_data_blocks %>%
  gt() %>%
  cols_label(
    Threshold  = "Threshold",
    N_GER      = "N\nGermany",
    Mean_GER   = "Mean\nGermany",
    SD_GER     = "SD\nGermany",
    Range_GER  = "Range\nGermany",
    N_USA      = "N\nUSA",
    Mean_USA   = "Mean\nUSA",
    SD_USA     = "SD\nUSA",
    Range_USA  = "Range\nUSA"
  ) %>%
  fmt_number(
    columns = c(Mean_GER, Mean_USA, SD_GER, SD_USA),
    decimals = 2
  ) %>%
  cols_width(
    Threshold ~ px(150),
    N_GER:N_USA ~ px(80),
    Mean_GER:SD_USA ~ px(80),
    Range_GER:Range_USA ~ px(120)
  ) %>%
  tab_style(
    style = cell_text(style = "italic"),
    locations = cells_column_labels(
      columns = c(N_GER, Mean_GER, SD_GER, Range_GER, N_USA, Mean_USA, SD_USA, Range_USA)
    )
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.font.size = px(17),
    table.width = pct(100),
    column_labels.font.weight = "bold",
    table.align = "center"
  )

# Tabelle anzeigen
apa_survey_table_blocks

# Tabelle speichern
gtsave(
  apa_survey_table_blocks,
  "Table_Survey_GER_USA_Blocks.png"
)



# Risiken den Domains zugeordnet
risks_data <- tibble::tribble(
  ~Health,                      ~Crime,                  ~Nature,                     ~Social_Political,
  "Vaccination Side Effects",    "Sexual Assault",        "Climate Change",            "Illegal Immigration",
  "Viral Pandemic",              "Gun Violence",          "Natural Disasters",         "Political Corruption",
  "Mental Health Problems",      "Terrorism",             "Nuclear Power Plant Incident", "Economic Crisis"
)

# APA-konforme Tabelle mit gt
apa_risks_table <- risks_data %>%
  gt() %>%
  cols_label(
    Health = "Health",
    Crime = "Crime",
    Nature = "Nature",
    Social_Political = "Social/Political"
  ) %>%
  tab_options(
    table.font.names = "Arial",
    table.font.size = px(20),
    table.width = pct(90),
    column_labels.font.weight = "bold",
    table.align = "center"
  )

# Tabelle anzeigen
apa_risks_table

# Tabelle speichern
gtsave(
  apa_risks_table,
  "Table_Risks_by_Domain.png"
)

```

```{r}
```

```{r}
```

```{r}
```


```{r}
# Calculate the mean age for all participants by country
mean_age_all <- df_3_tresh_cleaned %>%
  group_by(Country) %>%
  summarise(Mean_Age = mean(age, na.rm = TRUE))  # Calculates the mean age for each country, ignoring NA values

# Calculate the mean age by gender for each country
mean_age_gender <- df_3_tresh_cleaned %>%
  group_by(Country, gender) %>%
  summarise(Mean_Age = mean(age, na.rm = TRUE), .groups = "drop")  # Drop grouping after summarizing  # Calculates the mean age by gender for each country, ignoring NA values

# Display the results
print(mean_age_all)  # Prints the mean age for all participants by country
print(mean_age_gender)  # Prints the mean age by gender for each country

# Summary of the Age Distribution for US and Germany Participants
age_summary_us <- summary(df_3_tresh_cleaned$age[df_3_tresh_cleaned$Country == "US"])
age_summary_de <- summary(df_3_tresh_cleaned$age[df_3_tresh_cleaned$Country == "DE"])

# Print age summaries
print("Age Summary for US Participants:")
print(age_summary_us)

print("Age Summary for Germany Participants:")
print(age_summary_de)

# SD German participants
sd(df_3_tresh_cleaned$age[df_3_tresh_cleaned$Country == "US"], na.rm = TRUE)

# SD US participants
sd(df_3_tresh_cleaned$age[df_3_tresh_cleaned$Country == "DE"], na.rm = TRUE)

# SD by gender in the USA
tapply(df_3_tresh_cleaned$age[df_3_tresh_cleaned$Country == "US"], 
       df_3_tresh_cleaned$gender[df_3_tresh_cleaned$Country == "US"], 
       sd, na.rm = TRUE)

# SD by gender in Germany
tapply(df_3_tresh_cleaned$age[df_3_tresh_cleaned$Country == "DE"], 
       df_3_tresh_cleaned$gender[df_3_tresh_cleaned$Country == "DE"], 
       sd, na.rm = TRUE)

# SD for German participants
sd_de <- sd(df_3_tresh_cleaned$age[df_3_tresh_cleaned$Country == "DE"], na.rm = TRUE)
print(paste("SD Age Germany:", round(sd_de, 2)))

# SD for US participants
sd_us <- sd(df_3_tresh_cleaned$age[df_3_tresh_cleaned$Country == "US"], na.rm = TRUE)
print(paste("SD Age US:", round(sd_us, 2)))

# SD by gender in the US
sd_by_gender_us <- tapply(df_3_tresh_cleaned$age[df_3_tresh_cleaned$Country == "US"], 
                          df_3_tresh_cleaned$gender[df_3_tresh_cleaned$Country == "US"], 
                          sd, na.rm = TRUE)
print("SD by gender in US:")
print(round(sd_by_gender_us, 2))

# SD by gender in Germany
sd_by_gender_de <- tapply(df_3_tresh_cleaned$age[df_3_tresh_cleaned$Country == "DE"], 
                          df_3_tresh_cleaned$gender[df_3_tresh_cleaned$Country == "DE"], 
                          sd, na.rm = TRUE)
print("SD by gender in Germany:")
print(round(sd_by_gender_de, 2))


```

```{r}
# Categorize participants into age groups based on their age for both the US and Germany
df_3_tresh_cleaned <- df_3_tresh_cleaned %>%
  mutate(age_group = case_when(
    age >= 18 & age <= 29 ~ "18-29",
    age >= 30 & age <= 44 ~ "30-44",
    age >= 45 & age <= 59 ~ "45-59",
    age >= 60 & age <= 74 ~ "60-74",
    age >= 75 ~ "75+",
    TRUE ~ "NA"  # In case there are ages outside the given groups
  ))

# Summarize the age groups by gender and country
age_gender_summary <- df_3_tresh_cleaned %>%
  group_by(Country, gender, age_group) %>%
  summarise(count = n(), .groups = 'drop')

# Display the summary
print(age_gender_summary)

```

- Germany Age Groups:

The largest age group in the German sample is the female group aged 60-74, with 309 participants. In comparison, the largest male group is the 60-74 age group with 231 participants.

The age distribution shows that there are more women than men in the middle-aged groups, with particularly high numbers of female participants in the 30-44 years (190 women) and 45-59 years (230 women) age groups. For the younger groups (18-29 years), the gender difference is smaller, with 72 females and 99 males.

For the older groups (75+), the number of women (68 participants) is higher than that of men (29 participants), though these groups have fewer participants overall.

- U.S. Age Groups:

The largest age group in the U.S. female sample is the 60-74 age group, with 344 participants. The largest male group is the 60-74 age group as well, with 248 participants.

 For females, there are 97 participants in the 18-29 age group, and for males, there are 60 participants in the same age range. This indicates that the younger age groups make up a relatively smaller portion of the overall sample, with a notable difference between females and males.

As we move into the 30-44 and 45-59 age groups, the representation increases, particularly for females (182 and 209 participants, respectively).

For the older age groups (75+), the number of women (110 participants) outnumbers the men (100 participants), although both groups have notable representation in this category.


```{r, fig.width=10, fig.height=5}
# Barplot for age groups by gender (excluding 'Other'), faceted by country (US and DE), with separate bars for each gender and equal bar width
ggplot(df_3_tresh_cleaned %>%
         filter(!is.na(age_group) & gender != "Other"),  # Removes NA values from 'age_group' and excludes 'Other' gender
       aes(x = age_group, fill = gender)) +  # Fill by gender
  geom_bar(stat = "count", position = "dodge", width = 0.8, na.rm = TRUE) +  # Set width for equal bar width
  labs(title = "Age Groups by Gender (Threshold: 3 Minutes)", 
       x = "Age Group", 
       y = "Number of Participants") +
  theme_minimal() +  # Minimalistic theme
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),  # Rotate X-axis labels for better readability
    plot.title = element_text(hjust = 0.5, size = 16),  # Title centered without bold
    axis.title = element_text(size = 14),  # Set axis title size
    axis.text = element_text(size = 12)    # Set axis text size
  ) +
  facet_wrap(~Country) +  # Facet by country (US and DE)
  scale_fill_manual(values = c("Female" = "salmon", "Male" = "lightblue"))  # Custom colors for gender (no 'Other')

```

# Education Visualization and Description

- US Education Levels: In the US, the most common education level is the High school diploma, with 462 participants. This is followed by a high school diploma (462) those with a Bachelor’s degree (392 participants) and Some college (543 participants). A relatively small number of participants hold a Master’s degree (154) or Doctoral degree (37). Additionally, Less than high school education was reported by 62 participants, and there were 5 participants who had no formal school education.

- Germany Education Levels: In Germany, the most common education level is also the High school diploma, with 400 participants. This is closely followed by less than high school (389), Bachelor’s degree (279 participants) and Master’s degree (263 participants). The number of participants with Some college is 187, and Doctoral degree holders are fewer (26 participants). There are 389 participants who reported having Less than high school education, and 46 participants have no formal school education.

```{r}
# Sort data by frequency for US and Germany
education_sorted_us <- df_3_tresh_cleaned %>%
  filter(Country == "US") %>%
  count(education) %>%
  arrange(desc(n))

education_sorted_de <- df_3_tresh_cleaned %>%
  filter(Country == "DE") %>%
  count(education) %>%
  arrange(desc(n))

# Plot for US
ggplot(education_sorted_us, aes(x = reorder(education, -n), y = n, fill = education)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = n), vjust = -0.5) +
  labs(title = "Education Levels in the US",
       x = "Education Level",
       y = "Number of Participants") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "none") +
  ylim(0, 600)  # Set y-axis limit to 600

# Plot for Germany
ggplot(education_sorted_de, aes(x = reorder(education, -n), y = n, fill = education)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = n), vjust = -0.5) +
  labs(title = "Education Levels in Germany",
       x = "Education Level",
       y = "Number of Participants") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "none") +
  ylim(0, 600)  # Set y-axis limit to 600

```

```{r}
# Education Levels Table for both US and Germany
education_table_us <- table(df_3_tresh_cleaned$education[df_3_tresh_cleaned$Country == "US"])
education_table_de <- table(df_3_tresh_cleaned$education[df_3_tresh_cleaned$Country == "DE"])

# Print the tables
print("Education Levels in the US:")
print(education_table_us)

print("Education Levels in Germany:")
print(education_table_de)
```


# Correlation of the two Political scales

The correlation between the Left-Right Political Value and the Liberal-Conservative Political Value was analyzed separately for U.S. and German participants. 
For the U.S. sample, a strong positive correlation of 0.76 was found.
For the German sample, a strong to moderate positive correlation of 0.67 was observed, suggesting a similar, though slightly weaker, relationship between the two political scales. 
These results indicate a notable association between the two political dimensions in both countries, with a stronger correlation observed in the U.S.

In the US sample we observe a concentration of points at values 0, 5, and 10, which could indicate that many participants are positioned either in the middle (neutral) or at the extreme ends of the political scale.
In the German sample, there are fewer clusters at the 10 and 0 points, but there is a strong concentration in the middle around 5.

In both samples there are also participants who selected a 10 on the Left-Right scale and a 0 on the Liberal-Conservative scale, and vice versa. This contradiction may suggest that some participants did not answer the scales carefully or it may indicate differing interpretations of the scales or confusion about their meanings.
```{r}
# Calculate the correlation for US participants
correlation_result_us <- cor(df_3_tresh_cleaned[df_3_tresh_cleaned$Country == "US", ]$LibConsPolitValue,
                             df_3_tresh_cleaned[df_3_tresh_cleaned$Country == "US", ]$LeftRightPolitValue,
                             use = "complete.obs")

# Scatterplot with jitter and a blue regression line for US
df_3_tresh_cleaned %>% 
  filter(Country == "US") %>%
  ggplot(aes(LeftRightPolitValue, LibConsPolitValue)) +
  geom_point(position = "jitter") +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +  # Adds a linear regression line in blue
  labs(
    title = "Relationship between Left-Right and Liberal-Conservative Political Values",
    x = "Left-Right Political Value",
    y = "Liberal-Conservative Political Value"
  ) +
  annotate("text", x = 1, y = 10.5, label = paste("Correlation: ", round(correlation_result_us, 2)), 
           color = "red", size = 5, hjust = 0) +  # Move annotation outside data points
  theme_minimal()

# Calculate the correlation for DE participants
correlation_result_de <- cor(df_3_tresh_cleaned[df_3_tresh_cleaned$Country == "DE", ]$LibConsPolitValue,
                             df_3_tresh_cleaned[df_3_tresh_cleaned$Country == "DE", ]$LeftRightPolitValue,
                             use = "complete.obs")

# Scatterplot with jitter and a blue regression line for DE
df_3_tresh_cleaned %>% 
  filter(Country == "DE") %>%
  ggplot(aes(LeftRightPolitValue, LibConsPolitValue)) +
  geom_point(position = "jitter") +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +  # Adds a linear regression line in blue
  labs(
    title = "Relationship between Left-Right and Liberal-Conservative Political Values",
    x = "Left-Right Political Value",
    y = "Liberal-Conservative Political Value"
  ) +
  annotate("text", x = 1, y = 10.5, label = paste("Correlation: ", round(correlation_result_de, 2)), 
           color = "red", size = 5, hjust = 0) +  # Move annotation outside data points
  theme_minimal()


```

## Contradictory Responses and exploring the Inconsistencies

In this analysis, participants are flagged as having contradictory responses if the difference between their Left-Right Political Value and Lib-Cons Political Value is exactly 10. This threshold can be adjusted if necessary to account for variations in the responses.

There are 6 contradictory responses in the German sample and 18 contradictory responses in the US sample.
In the German sample (N = 1,591), 0.38% of responses were flagged as contradictory, while in the U.S. sample (N = 1,654), 1.09% of responses were flagged as contradictory. The small percentage of contradictory responses seems negligible and unlikely to significantly impact the overall validity of the sample, making it not a critical issue.

If we have a closer look at the contradictory responses by gender, age, and education we see:

- Germany: There are equal contradictory responses between males and females (3 each). In terms of age, contradictory responses are spread across different age groups, with the most occurring in the 30-44 age group (3 responses), followed by 2 responses in the 60-74 age group and 1 response in the 75+ age group. Regarding education levels, most education categories show very few contradictory responses, with the highest counts found in the "Less than high school" group (2 responses), and Master's degree (2 responses), followed by "High school diploma" (1 response), and some college (1 response).

- U.S.: Females show a higher number of contradictory responses (11) compared to males (7). The 45-59 age group has the most contradictory responses (6), followed by the 30-44 age group (5). For education, the "High school diploma" category stands out with 8 contradictory responses followed by some college (6 responses) while "Bachelor’s degree" has 3, and 	Doctoral degree only has 1 response.

The appearance of a pattern is likely due to sample characteristics rather than any correlation between age, education, and contradictory responses.

```{r}
# column to flag contradictory responses based on a 10-point difference
df_3_tresh_cleaned <- df_3_tresh_cleaned %>%
  mutate(contradictory = abs(LibConsPolitValue - LeftRightPolitValue) == 10)

# number of contradictory responses for both countries (US and Germany)
num_contradictory <- df_3_tresh_cleaned %>%
  group_by(Country) %>%
  summarise(num_contradictory = sum(contradictory, na.rm = TRUE))

# Display the result
print(num_contradictory)

# Exploring contradictory responses by gender, age, and education for both countries
contradictory_by_gender <- df_3_tresh_cleaned %>%
  group_by(Country, gender) %>%
  summarise(contradictory_count = sum(contradictory, na.rm = TRUE))

contradictory_by_age <- df_3_tresh_cleaned %>%
  group_by(Country, age_group) %>%
  summarise(contradictory_count = sum(contradictory, na.rm = TRUE))

contradictory_by_education <- df_3_tresh_cleaned %>%
  group_by(Country, education) %>%
  summarise(contradictory_count = sum(contradictory, na.rm = TRUE))

# Print the results
print(contradictory_by_gender)
print(contradictory_by_age)
print(contradictory_by_education)

```

## Visualization and Distribution of Political Values

# Left-Right and Lib-Con Political Value Scale Distribution Description

U.S. sample: 
- Left-Right: Most respondents position themselves at the center (value 5, 31.5%), with notable peaks at the extreme right (10, 11.1%), extreme left (0, 8.9%), and also at 8 (9.7%). The rest are more evenly distributed.
- Lib-Con: The Lib-Con scale follows a similar pattern to the Left-Right scale, with the highest concentration at the center (value 5, 27.8%). There are also notable peaks at the extreme conservative end (10, 11.5%) and at 8 (12.1%). Additionally, a smaller but notable portion of respondents chose 0 (8.3%), representing the most liberal position.

German sample:
- Left-Right: The Left-Right scale is also centered around 5, with 33.8% of respondents choosing this middle value. Compared to the U.S., fewer respondents selected the extreme values, with only 4.6% at 10 and 3.9% at 0. There is also a notable proportion at 6 (13.6%), while other values are more evenly distributed.
- Lib-Con: The distribution is again centered around the midpoint, with 36.2% selecting 5. The values 6 (10.8%), 8 (9.6%), and 4 (8.4%) also show notable frequencies. Extreme values (0 and 10) are chosen less frequently, each around 3.9% to 5.4%, indicating a more balanced distribution with fewer respondents at the ideological extremes.

Observation:
What we observe is that in the United States, there is a stronger distribution at the poles on both scales, with both 0 and 10 showing higher values compared to Germany. However, both countries show a strong concentration in the middle, particularly at 5, indicating a significant presence of political centrism in both samples. The difference lies in the USA having more responses at the extremes, while Germany's responses are more centered around the middle.
-> political attitudes in the USA tend to be more polarized and focused on extreme values.

A higher correlation between the two political scales in the U.S. could suggest that, in this country, people's political views are more closely aligned, meaning that someone who positions themselves strongly on the 'Left-Right' axis also strongly aligns on the 'Lib-Con' axis. In Germany, a lower correlation could indicate that there is less of a clear alignment between these two dimensions, or that people who identify as politically left or right do not necessarily express their views on social or cultural politics (liberal vs. conservative) on the same scale.


```{r}
# Frequency distribution for Left-Right (for US)
freq_table_us <- df_3_tresh_cleaned %>%
  filter(Country == "US") %>%
  group_by(LeftRightPolitValue) %>%
  summarise(count = n()) %>%
  mutate(percent = (count / sum(count)) * 100) %>%
  arrange(LeftRightPolitValue)

# Frequency distribution for Lib-Con (for US)
freq_libcons_us <- df_3_tresh_cleaned %>%
  filter(Country == "US") %>%
  group_by(LibConsPolitValue) %>%
  summarise(count = n()) %>%
  mutate(percent = (count / sum(count)) * 100) %>%
  arrange(LibConsPolitValue)

# Frequency distribution for Left-Right (for Germany)
freq_table_de <- df_3_tresh_cleaned %>%
  filter(Country == "DE") %>%
  group_by(LeftRightPolitValue) %>%
  summarise(count = n()) %>%
  mutate(percent = (count / sum(count)) * 100) %>%
  arrange(LeftRightPolitValue)

# Frequency distribution for Lib-Con (for Germany)
freq_libcons_de <- df_3_tresh_cleaned %>%
  filter(Country == "DE") %>%
  group_by(LibConsPolitValue) %>%
  summarise(count = n()) %>%
  mutate(percent = (count / sum(count)) * 100) %>%
  arrange(LibConsPolitValue)

# Print the tables
print(freq_table_us)
print(freq_libcons_us)
print(freq_table_de)
print(freq_libcons_de)

```


```{r}
# Visualization for Left-Right (for both US and Germany)
ggplot(df_3_tresh_cleaned %>%
         filter(Country %in% c("US", "DE"), !is.na(LeftRightPolitValue)),  # Filter out missing values
       aes(x = LeftRightPolitValue, fill = Country)) +
  geom_bar(stat = "count", position = "dodge", show.legend = FALSE) +
  labs(title = "Frequency Distribution: Left-Right Political Value",
       x = "Left-Right Political Value",
       y = "Count") +
  scale_x_continuous(breaks = seq(0, 10, by = 1)) +  # Ensure the full range is included
  scale_y_continuous(limits = c(0, 600)) + 
  theme_minimal() +
  facet_wrap(~ Country)  # Facet by country

# Visualization for Lib-Con (for both US and Germany)
ggplot(df_3_tresh_cleaned %>%
         filter(Country %in% c("US", "DE"), !is.na(LibConsPolitValue)),  # Filter out missing values
       aes(x = LibConsPolitValue, fill = Country)) +
  geom_bar(stat = "count", position = "dodge", show.legend = FALSE) +
  labs(title = "Frequency Distribution: Lib-Con Political Value",
       x = "Lib-Con Political Value",
       y = "Count") +
  scale_x_continuous(breaks = seq(0, 10, by = 1)) +  # Ensure the full range is included
  scale_y_continuous(limits = c(0, 600)) + 
  theme_minimal() +
  facet_wrap(~ Country)  # Facet by country

# Visualization for Left-Right (for both US and Germany) in percentages
ggplot(df_3_tresh_cleaned %>%
         filter(Country %in% c("US", "DE"), !is.na(LeftRightPolitValue)) %>%
         group_by(Country, LeftRightPolitValue) %>%
         summarise(count = n()) %>%
         mutate(percent = (count / sum(count)) * 100),  # Calculate percentages
       aes(x = LeftRightPolitValue, y = percent, fill = Country)) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  labs(title = "Percentage Distribution: Left-Right Political Value",
       x = "Left-Right Political Value",
       y = "Percentage") +
  scale_x_continuous(breaks = seq(0, 10, by = 1)) +  # Ensure the full range is included
  theme_minimal() +
  facet_wrap(~ Country)  # Facet by country

# Visualization for Lib-Con (for both US and Germany) in percentages
ggplot(df_3_tresh_cleaned %>%
         filter(Country %in% c("US", "DE"), !is.na(LibConsPolitValue)) %>%
         group_by(Country, LibConsPolitValue) %>%
         summarise(count = n()) %>%
         mutate(percent = (count / sum(count)) * 100),  # Calculate percentages
       aes(x = LibConsPolitValue, y = percent, fill = Country)) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +
  labs(title = "Percentage Distribution: Lib-Con Political Value",
       x = "Lib-Con Political Value",
       y = "Percentage") +
  scale_x_continuous(breaks = seq(0, 10, by = 1)) +  # Ensure the full range is included
  theme_minimal() +
  facet_wrap(~ Country)  # Facet by country


```


# Combining the two Political Scales into one Scale: Political Ideology Scale

Given the high correlation (0.76 for the US and 0.67 for Germany) between the two political scales, Left-Right Political Value and Liberal-Conservative Political Value, I combined these two scales into a single composite measure. This was done by averaging the values of both scales for each participant. The new variable, CombinedPoliticalValue, provides a simplified representation of participants' political orientation.
I focus on the overall alignment of political orientation and that does not require a detailed differentiation between the two dimensions of political orientation (Left-Right vs. Liberal-Conservative).

- Combined Scale: Political Ideology Scale

The Political Ideology Scale is a combination of two original scales: the Left/Right wing scale and the Liberal/Conservative scale, both of which originally had a 0-10 range with whole number increments. This resulted in 11 possible positions on each scale. With the integration of these two scales, the new Political Ideology Scale now allows for half-point increments, ranging from 0.0 to 10.0, resulting in 21 distinct positions.

This increased granularity provides a more precise measurement of political orientation, capturing subtler differences in ideology. The inclusion of half-point increments offers a more accurate representation of participants' views, which could be beneficial for more detailed statistical analyses and a better understanding of political perspectives.

# Frequency table for the Political Ideology Scale:

Both countries show a centrism toward 5.0 on the CombinedPoliticalValue scale, suggesting that most participants' political ideologies are centered around the middle of the political spectrum.

- Germany: 
The distribution of CombinedPoliticalValue for Germany reveals a clear concentration around the middle of the political spectrum. The highest proportion of participants, 28.36%, fall at the center of the scale (value = 5.0). In addition, there is noticeable clustering around nearby values, with 7.86% selecting 6.0, 7.04% of participants selecting 4.0, and 6.16% selecting 5.5.
These findings suggest that a significant portion of the population aligns with moderate political ideologies.

At the extremes of the scale, only a small fraction of participants identified with the values of 0.0 and 10.0, with 1.89% and 3.21% of participants, respectively. This distribution reflects a trend toward a more centrist political orientation within the sample, with fewer individuals adopting extreme positions.

- USA:
The CombinedPoliticalValue distribution for the United States shows a notable concentration around the middle of the political spectrum, but with some important differences. The highest proportion of participants, 23.38%, selected the central value of 5.0. However, values at the extremes (0.0 and 10.0) also saw significant representation, with 6.53% selecting 0.0 and 8.04% selecting 10.0, indicating a notable proportion of participants who identified with the far-left or far-right ends of the scale.

Values near the center, such as 6.0 and 4.0, were also selected by 6.10% and 4.95% of participants. There were other moderate values, such as 7.5 (4.95%) and 8.0 (6.77%), but these were less frequent compared to the extremes. The relatively high representation at both ends of the scale suggests a more polarized political landscape in the sample, compared to Germany, where the extremes were less frequently chosen.

- Short Description:
The median is 5 in both countries, reflecting a balanced distribution. However, the mean for the U.S. (5.45) is slightly higher than Germany's (5.21), indicating a slight rightward skew in the U.S. sample. The standard deviation is higher in the U.S. (2.68) compared to Germany (2.09), suggesting more variation in political ideology among U.S. participants. The U.S. sample also has a higher third quartile (Q3). For the U.S., the Q3 value is 7.5, meaning that 75% of participants scored below 7.5, with the top 25% scoring above this value, indicating a stronger right-wing inclination relative to Germany. In contrast, Germany's Q3 value is 6.5, meaning the distribution of political ideologies is somewhat more centered around the middle of the scale compared to the U.S., with fewer participants scoring in the higher right-wing range.

```{r}
# Creating a new variable that combines both political scales
df_3_tresh_cleaned <- df_3_tresh_cleaned %>%
  mutate(CombinedPoliticalValue = (LeftRightPolitValue + LibConsPolitValue) / 2)

# Summary for CombinedPoliticalValue by Country (US and DE)
df_3_tresh_cleaned %>%
  filter(Country %in% c("US", "DE")) %>%
  group_by(Country) %>%
  summarise(
    min = min(CombinedPoliticalValue, na.rm = TRUE),
    Q1 = quantile(CombinedPoliticalValue, 0.25, na.rm = TRUE),
    median = median(CombinedPoliticalValue, na.rm = TRUE),
    mean = mean(CombinedPoliticalValue, na.rm = TRUE),
    Q3 = quantile(CombinedPoliticalValue, 0.75, na.rm = TRUE),
    max = max(CombinedPoliticalValue, na.rm = TRUE),
    sd = sd(CombinedPoliticalValue, na.rm = TRUE)
  )


# Visualization for the Combined Political Scale (for both US and Germany)
ggplot(df_3_tresh_cleaned %>%
         filter(Country %in% c("US", "DE"), !is.na(CombinedPoliticalValue)),  # Filter out missing values
       aes(x = CombinedPoliticalValue, fill = Country)) +
  geom_bar(stat = "count", position = "dodge", show.legend = FALSE) +
  labs(title = "Frequency Distribution: Political Ideology Scale",
       x = "Political Ideology Scale",
       y = "Count") +
  scale_x_continuous(breaks = seq(0, 10, by = 1)) +  # Ensure the full range is included
  scale_y_continuous(limits = c(0, 500)) +  # Adjust limit based on your data
  theme_minimal() +
  facet_wrap(~ Country)  # Facet by country

# Visualization for the Combined Political Scale (with percentages)
ggplot(df_3_tresh_cleaned %>%
         filter(Country %in% c("US", "DE"), !is.na(CombinedPoliticalValue)) %>%
         group_by(Country, CombinedPoliticalValue) %>%
         summarise(count = n()) %>%
         mutate(percent = (count / sum(count)) * 100),  # Calculate percentage
       aes(x = CombinedPoliticalValue, y = percent, fill = Country)) +
  geom_bar(stat = "identity", position = "dodge", show.legend = FALSE) +  # Change stat to 'identity' for percentages
  labs(title = "Percentage Distribution: Political Ideology Scale",
       x = "Political Ideology Scale",
       y = "Percentage") +
  scale_x_continuous(breaks = seq(0, 10, by = 1)) +  # Ensure the full range is included
  scale_y_continuous(limits = c(0, 35)) +  # Adjust limit based on the percentage range
  theme_minimal() +
  facet_wrap(~ Country)  # Facet by country

# Germany: Percentage Distribution of CombinedPoliticalValue
freq_combined_de <- df_3_tresh_cleaned %>%
  filter(Country == "DE") %>%
  group_by(CombinedPoliticalValue) %>%
  summarise(count = n()) %>%
  mutate(percent = (count / sum(count)) * 100) %>%
  arrange(CombinedPoliticalValue)

# United States: Percentage Distribution of CombinedPoliticalValue
freq_combined_us <- df_3_tresh_cleaned %>%
  filter(Country == "US") %>%
  group_by(CombinedPoliticalValue) %>%
  summarise(count = n()) %>%
  mutate(percent = (count / sum(count)) * 100) %>%
  arrange(CombinedPoliticalValue)

# Results
print(freq_combined_de)
print(freq_combined_us)
```

 # APA Table with the Distribution of the Combined Political Scale Germany (short)
```{r}
# Deutschland Tabelle mit den wichtigsten Zahlen (ohne "Most frequent value (Mode)")
germany_summary <- tibble::tibble(
  `Scale Point / Statistic` = c(
    "0.0 (Far-left)", "4.0", "5.0 (Midpoint)", "5.5", "6.0", "10.0 (Far-right)", 
    "Median", "Mean", "Standard Deviation", "Third Quartile (Q3)"
  ),
  Germany = c(
    "1.89", "7.04", "28.36", "6.16", "7.86", "3.21", 
    "5.0", "5.21", "2.09", "6.5"
  )
)

# Erstellen und formatieren der Tabelle
apa_germany_summary <- germany_summary %>%
  gt() %>%
  
  # Zahlen formatieren
  fmt_number(columns = c(Germany), decimals = 2) %>%
  
  # Formatierung der Zeilen (fett für Deskriptivstatistiken)
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(
      rows = `Scale Point / Statistic` %in% c("Median", "Mean", "Standard Deviation", "Third Quartile (Q3)")
    )
  ) %>%
  
  # Formatierungen für die Tabelle
  tab_options(
    table.width = pct(100),
    table.font.names = "Arial",
    table.font.size = px(18),
    column_labels.font.weight = "bold",
    data_row.padding = px(5),
    heading.padding = px(5),
    column_labels.padding = px(5)
  ) %>%
  
  # Zentrierte Ausrichtung
  cols_align(align = "center", columns = everything())

# Tabelle anzeigen
apa_germany_summary

# Speichern der Tabelle als PNG-Datei
gtsave(apa_germany_summary, "Germany_Polit_Orientation.png")

```
# APA Table with the Distribution of the Combined Political Scale USA (short)
```{r}
# USA Tabelle mit den wichtigsten Zahlen
usa_summary <- tibble::tibble(
  `Scale Point / Statistic` = c(
    "0.0 (Far-left)", "4.0", "5.0 (Midpoint)", "6.0", "7.5", "8.0", "10.0 (Far-right)",
    "Median", "Mean", "Standard Deviation", "Third Quartile (Q3)"
  ),
  U.S. = c(
    "6.53", "4.95", "23.38", "6.10", "4.95", "6.77", "8.04",
    "5.0", "5.45", "2.68", "7.5"
  )
)

# Tabelle formatieren und speichern
apa_usa_summary <- usa_summary %>%
  gt() %>%
  
  # Zahlen formatieren
  fmt_number(columns = c(U.S.), decimals = 2) %>%
  
  # Formatierung der Zeilen (fett für Deskriptivstatistiken)
  tab_style(
    style = cell_text(weight = "bold"),
    locations = cells_body(
      rows = `Scale Point / Statistic` %in% c("Median", "Mean", "Standard Deviation", "Third Quartile (Q3)")
    )
  ) %>%
  
  # Formatierungen für die Tabelle
  tab_options(
    table.width = pct(100),
    table.font.names = "Arial",
    table.font.size = px(18),
    column_labels.font.weight = "bold",
    data_row.padding = px(5),
    heading.padding = px(5),
    column_labels.padding = px(5)
  ) %>%
  
  # Zentrierte Ausrichtung
  cols_align(align = "center", columns = everything())

# Tabelle anzeigen
apa_usa_summary

# Speichern der Tabelle als PNG-Datei
gtsave(apa_usa_summary, "US_Polit_Orientation.png")
```







# APA Table Germany (long for Appendix)
```{r}
# Germany Data (summary of scale points 0.0 to 10.0 with given frequencies and percentages)
germany_data <- tibble::tibble(
  `Scale Point` = seq(0, 10, 0.5),
  Frequency = c(30, 10, 28, 24, 53, 46, 61, 59, 112, 76, 451, 98, 125, 72, 72, 74, 78, 37, 23, 10, 51),  # Frequencies for Germany
  Percent = c(1.89, 0.63, 1.76, 1.51, 3.33, 2.89, 3.84, 3.71, 7.04, 4.78, 28.36, 6.16, 7.86, 4.53, 4.53, 4.65, 4.91, 2.33, 1.45, 0.63, 3.21)  # Percentages for Germany
)

# Create the gt table for Germany
apa_germany_table <- germany_data %>%
  gt() %>%
  
  # Label columns
  cols_label(
    `Scale Point` = "Scale Point",
    Frequency = "Frequency",
    Percent = "Percent (%)"
  ) %>%
  
  # Format percentages
  fmt_number(
    columns = vars(Percent),
    decimals = 2
  ) %>%
  
  # Format the table appearance
  tab_options(
    table.width = pct(100),
    table.font.names = "Arial",
    table.font.size = px(18),
    column_labels.font.weight = "bold",
    data_row.padding = px(5),
    heading.padding = px(5),
    column_labels.padding = px(5)
  ) %>%
  
  # Center-align all text
  cols_align(align = "center", columns = everything())

# Print the table
apa_germany_table

# Save as PNG
gtsave(apa_germany_table, "Germany_Political_Orientation_Scale.png")

```

# APA Table USA (long for Appendix)
```{r}
# USA Data for Combined Political Value Scale (0.0 to 10.0)
usa_combined_data <- tibble::tibble(
  `Scale Point` = seq(0, 10, 0.5),
  Frequency = c(108, 11, 32, 26, 48, 39, 57, 42, 82, 64, 387, 75, 101, 58, 64, 82, 112, 56, 54, 24, 133),  # Frequencies for USA
  Percent = c(6.53, 0.66, 1.93, 1.57, 2.90, 2.36, 3.44, 2.54, 4.95, 3.87, 23.38, 4.53, 6.10, 3.50, 3.87, 4.95, 6.77, 3.38, 3.26, 1.45, 8.04)  # Percentages for USA
)

# Create the gt table for USA with APA style
apa_usa_combined_table <- usa_combined_data %>%
  gt() %>%
  
  # Label columns
  cols_label(
    `Scale Point` = "Scale Point",
    Frequency = "Frequency",
    Percent = "Percent (%)"
  ) %>%
  
  # Format percentages
  fmt_number(
    columns = vars(Percent),
    decimals = 2
  ) %>%
  
  # Format the table appearance
  tab_options(
    table.width = pct(100),
    table.font.names = "Arial",
    table.font.size = px(18),
    column_labels.font.weight = "bold",
    data_row.padding = px(5),
    heading.padding = px(5),
    column_labels.padding = px(5)
  ) %>%
  
  # Center-align all text
  cols_align(align = "center", columns = everything())

# Print the table
apa_usa_combined_table

# Save as PNG
gtsave(apa_usa_combined_table, "USA_Combined_Political_Orientation_Scale.png")

```

```{r}

```

# Mean Political Value and SD by gender
```{r}
# Germany
df_3_tresh_cleaned %>%
  filter(Country == "DE") %>%
  group_by(gender) %>%
  summarise(
    N = n(),
    Mean_Political_Identity = mean(CombinedPoliticalValue, na.rm = TRUE),
    SD_Political_Identity = sd(CombinedPoliticalValue, na.rm = TRUE)
  )

#US
df_3_tresh_cleaned %>%
  filter(Country == "US") %>%
  group_by(gender) %>%
  summarise(
    N = n(),
    Mean_Political_Identity = mean(CombinedPoliticalValue, na.rm = TRUE),
    SD_Political_Identity = sd(CombinedPoliticalValue, na.rm = TRUE)
  )
```



## Regression lines and Correlations between the Political Scale and Risks by Dimensions

For each risk, I created a plot where the y-axis represents the risk perception and the x-axis represents the political orientation. The plot includes regression lines for each country, allowing us to observe how individuals from different political orientations perceive a specific risk.

Two regression lines are shown: blue for the USA and red for Germany. This allows for an easy comparison of how the political orientation influences risk perception in both countries. The plots are divided by the different risk dimensions, which enables a detailed analysis of each risk domain in the following order from top to the bottom: health, crime, nature, and social/political.

The main focus of these plots lies in the regression lines, as they allow for a clear comparison of country differences in how political orientation affects risk perception. To avoid visual clutter, the individual data points are displayed in black. While this decision means that we lose the ability to differentiate the points by country, it helps to focus on the regression lines, making it easier to compare the countries based on their respective trends.

Visually comparing the data, differences in the risks and regression lines between countries (USA and Germany) are clearly noticeable. However, when looking at the data across the different dimensions, no strong differences are observed visually. This suggests that while political orientation may influence risk perception differently for each specific risk, the overall impact across dimensions does not appear to vary significantly.

- Affect Dimension

```{r, fig.width=12, fig.height=8}

df_3_tresh_cleaned_long %>%
  filter(Risk_Dimension_f == "Affect") %>%  # Choose the desired dimension
  mutate(Risk_f = fct_relevel(Risk_f, 
                              # Health
                              "Vaccination", "ViralPandemic", "MentHealthProb", 
                              # Crime
                              "SexAssault", "GunViol", "Terrorism", 
                              # Nature
                              "ClimateChange", "NaturalDisast", "NuclPowerPlant", 
                              # Social/Political
                              "IllegImmigrat", "PolitCorrupt", "EconCrisis")) %>%
  
  ggplot(aes(x = CombinedPoliticalValue, y = Rating)) +  # No country-specific coloring for points
  
  # Points to show the data, black for all countries
  geom_jitter(alpha = .2, color = "black") +  # Black points for all countries
  
  # Regressions line for USA and Germany (one line per country)
  geom_smooth(data = filter(df_3_tresh_cleaned_long, Country_f == "US"), 
              method = "lm", se = FALSE, aes(color = "USA")) +  # Blue line for US
  
  geom_smooth(data = filter(df_3_tresh_cleaned_long, Country_f == "DE"), 
              method = "lm", se = FALSE, aes(color = "Germany")) +  # Red line for DE
  
  # Facet the plot by risk categories, sorted by domain
  facet_wrap(
    ~ Risk_f, 
    scales = "fixed",    # Same axis for better comparison
    ncol = 3,            # 3 columns
    nrow = 4,            # 4 rows
    labeller = labeller(
      Risk_f = c(
        "Vaccination" = "Vaccination Side Effects",
        "ViralPandemic" = "Viral Pandemic",
        "MentHealthProb" = "Mental Health Problems",
        "SexAssault" = "Sexual Assault",
        "GunViol" = "Gun Violence",
        "Terrorism" = "Terrorism",
        "ClimateChange" = "Climate Change",
        "NaturalDisast" = "Natural Disaster",
        "NuclPowerPlant" = "Nuclear Power Plant Incident",
        "IllegImmigrat" = "Illegal Immigration",
        "PolitCorrupt" = "Political Corruption",
        "EconCrisis" = "Economic Crisis"
      )
    )
  ) +
  
  labs(
    title = "The Impact of Political Orientation on Risk Perception (Affect)",
    x = "Political Orientation",
    y = "Risk Perception (Affect)",
    color = "Country",  # Color legend for country
    linetype = "Political Orientation"
  ) +

  # Customize colors for the countries (relevant for the lines)
  scale_color_manual(values = c("USA" = "blue", "Germany" = "red")) +
  
  theme_minimal() +  # Use a minimal theme
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    strip.text = element_text(size = 12)
  )

```


- Probability Dimension

```{r, fig.width=12, fig.height=8}

df_3_tresh_cleaned_long %>%
  filter(Risk_Dimension_f == "Probs") %>%  # Choose the desired dimension
  mutate(Risk_f = fct_relevel(Risk_f, 
                              # Health
                              "Vaccination", "ViralPandemic", "MentHealthProb", 
                              # Crime
                              "SexAssault", "GunViol", "Terrorism", 
                              # Nature
                              "ClimateChange", "NaturalDisast", "NuclPowerPlant", 
                              # Social/Political
                              "IllegImmigrat", "PolitCorrupt", "EconCrisis")) %>%
  
  ggplot(aes(x = CombinedPoliticalValue, y = Rating)) +  # No country-specific coloring for points
  
  # Points to show the data, black for all countries
  geom_jitter(alpha = .2, color = "black") +  # Black points for all countries
  
  # Regressions line for USA and Germany (one line per country)
  geom_smooth(data = filter(df_3_tresh_cleaned_long, Country_f == "US"), 
              method = "lm", se = FALSE, aes(color = "USA")) +  # Blue line for US
  
  geom_smooth(data = filter(df_3_tresh_cleaned_long, Country_f == "DE"), 
              method = "lm", se = FALSE, aes(color = "Germany")) +  # Red line for DE
  
  # Facet the plot by risk categories, sorted by domain
  facet_wrap(
    ~ Risk_f, 
    scales = "fixed",    # Same axis for better comparison
    ncol = 3,            # 3 columns
    nrow = 4,            # 4 rows
    labeller = labeller(
      Risk_f = c(
        "Vaccination" = "Vaccination Side Effects",
        "ViralPandemic" = "Viral Pandemic",
        "MentHealthProb" = "Mental Health Problems",
        "SexAssault" = "Sexual Assault",
        "GunViol" = "Gun Violence",
        "Terrorism" = "Terrorism",
        "ClimateChange" = "Climate Change",
        "NaturalDisast" = "Natural Disaster",
        "NuclPowerPlant" = "Nuclear Power Plant Incident",
        "IllegImmigrat" = "Illegal Immigration",
        "PolitCorrupt" = "Political Corruption",
        "EconCrisis" = "Economic Crisis"
      )
    )
  ) +
  
  labs(
    title = "The Impact of Political Orientation on Risk Perception (Probability)",
    x = "Political Orientation",
    y = "Risk Perception (Probability)",
    color = "Country",  # Color legend for country
    linetype = "Political Orientation"
  ) +

  # Customize colors for the countries (relevant for the lines)
  scale_color_manual(values = c("USA" = "blue", "Germany" = "red")) +
  
  theme_minimal() +  # Use a minimal theme
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    strip.text = element_text(size = 12)
  )

```

- Consequence Dimension

```{r, fig.width=12, fig.height=8}

df_3_tresh_cleaned_long %>%
  filter(Risk_Dimension_f == "Sever") %>%  # Choose the desired dimension
  mutate(Risk_f = fct_relevel(Risk_f, 
                              # Health
                              "Vaccination", "ViralPandemic", "MentHealthProb", 
                              # Crime
                              "SexAssault", "GunViol", "Terrorism", 
                              # Nature
                              "ClimateChange", "NaturalDisast", "NuclPowerPlant", 
                              # Social/Political
                              "IllegImmigrat", "PolitCorrupt", "EconCrisis")) %>%
  
  ggplot(aes(x = CombinedPoliticalValue, y = Rating)) +  # No country-specific coloring for points
  
  # Points to show the data, black for all countries
  geom_jitter(alpha = .2, color = "black") +  # Black points for all countries
  
  # Regressions line for USA and Germany (one line per country)
  geom_smooth(data = filter(df_3_tresh_cleaned_long, Country_f == "US"), 
              method = "lm", se = FALSE, aes(color = "USA")) +  # Blue line for US
  
  geom_smooth(data = filter(df_3_tresh_cleaned_long, Country_f == "DE"), 
              method = "lm", se = FALSE, aes(color = "Germany")) +  # Red line for DE
  
  # Facet the plot by risk categories, sorted by domain
  facet_wrap(
    ~ Risk_f, 
    scales = "fixed",    # Same axis for better comparison
    ncol = 3,            # 3 columns
    nrow = 4,            # 4 rows
    labeller = labeller(
      Risk_f = c(
        "Vaccination" = "Vaccination Side Effects",
        "ViralPandemic" = "Viral Pandemic",
        "MentHealthProb" = "Mental Health Problems",
        "SexAssault" = "Sexual Assault",
        "GunViol" = "Gun Violence",
        "Terrorism" = "Terrorism",
        "ClimateChange" = "Climate Change",
        "NaturalDisast" = "Natural Disaster",
        "NuclPowerPlant" = "Nuclear Power Plant Incident",
        "IllegImmigrat" = "Illegal Immigration",
        "PolitCorrupt" = "Political Corruption",
        "EconCrisis" = "Economic Crisis"
      )
    )
  ) +
  
  labs(
    title = "The Impact of Political Orientation on Risk Perception (Consequence)",
    x = "Political Orientation",
    y = "Risk Perception (Consequence)",
    color = "Country",  # Color legend for country
    linetype = "Political Orientation"
  ) +

  # Customize colors for the countries (relevant for the lines)
  scale_color_manual(values = c("USA" = "blue", "Germany" = "red")) +
  
  theme_minimal() +  # Use a minimal theme
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    strip.text = element_text(size = 12)
  )

```

#Test

```{r}


```


I am going to use correlation coefficients to quantify the relationship between political orientation and risk perception.

- Correlation of the Political Scale and Risk Ratings by Domains for USA and Germany

```{r}
# Calculate the correlation for USA
usa_correlation <- df_3_tresh_cleaned_long %>%
  filter(Country_f == "US") %>%
  group_by(Risk_Dimension_f, Risk_f) %>%
  summarize(correlation = cor(CombinedPoliticalValue, Rating, method = "pearson"), .groups = "drop")

# Calculate the correlation for Germany
germany_correlation <- df_3_tresh_cleaned_long %>%
  filter(Country_f == "DE") %>%
  group_by(Risk_Dimension_f, Risk_f) %>%
  summarize(correlation = cor(CombinedPoliticalValue, Rating, method = "pearson"), .groups = "drop")

# Combine the results for comparison
correlation_comparison <- bind_rows(
  usa_correlation %>% mutate(Country = "USA"),
  germany_correlation %>% mutate(Country = "Germany")
)

# View the results
print(correlation_comparison)
```


```{r, fig.width=12, fig.height=8}
# Create the correlation plot with custom labels for each risk
ggplot(correlation_comparison, aes(x = Risk_f, y = correlation, fill = Country)) +
  geom_bar(stat = "identity", position = "dodge") +  # Create grouped bar plot
  facet_wrap(
    ~ Risk_Dimension_f, 
    scales = "free_y", 
    labeller = labeller(
      Risk_Dimension_f = c(
        "Affect" = "Affect", 
        "Probs" = "Probability", 
        "Sever" = "Consequence"
      )
    )
  ) +  # Facet by risk dimensions with custom labels
  labs(
    title = "Correlation between Political Orientation and Risk Perception",
    subtitle = "Comparison of USA and Germany",
    x = "Risk",
    y = "Correlation",
    fill = "Country"
  ) +
  scale_x_discrete(labels = c(
    "Vaccination" = "Vaccination Side Effects",
    "ViralPandemic" = "Viral Pandemic",
    "MentHealthProb" = "Mental Health Problems",
    "SexAssault" = "Sexual Assault",
    "GunViol" = "Gun Violence",
    "Terrorism" = "Terrorism",
    "ClimateChange" = "Climate Change",
    "NaturalDisast" = "Natural Disaster",
    "NuclPowerPlant" = "Nuclear Power Plant Incident",
    "IllegImmigrat" = "Illegal Immigration",
    "PolitCorrupt" = "Political Corruption",
    "EconCrisis" = "Economic Crisis"
  )) +  # Custom labels for the risks
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10, angle = 45, hjust = 1),  # Rotate x-axis labels
    strip.text = element_text(size = 12),
    legend.position = "top"
  )
```

- Correlation of the Political Scale for the three Dimensions in USA and Germany

Correlations for USA:
Highest correlation: Probability (-0.0184)
Second-highest correlation: Affect (-0.0193)
Lowest correlation: Consequence (0.0067)

In the USA, the correlations between political orientation and risk perception are very weak, with all values close to zero, indicating no significant relationship.

Correlations for Germany:
Highest correlation: Probability (0.1379)
Second-highest correlation: Consequence (0.0567)
Lowest correlation: Affect (0.1115)

In Germany, the correlations are slightly more positive, particularly for Probability (0.1379) and Affect (0.1115), suggesting a slightly stronger relationship between political orientation and risk perception.

```{r}
# Calculate the correlation for USA over each of the three dimensions (Affect, Probability, Consequence)
usa_correlation_dimensions <- df_3_tresh_cleaned_long %>%
  filter(Country_f == "US") %>%
  group_by(Risk_Dimension_f) %>%
  summarize(correlation = cor(CombinedPoliticalValue, Rating, method = "pearson"), .groups = "drop") %>%
  filter(Risk_Dimension_f %in% c("Affect", "Probs", "Sever"))  # Filter for the three dimensions

# Rename Risk Dimension for better readability for USA
usa_correlation_dimensions$Risk_Dimension_f <- recode(usa_correlation_dimensions$Risk_Dimension_f,
                                                       "Affect" = "Affect",
                                                       "Probs" = "Probability",
                                                       "Sever" = "Consequence")

# Calculate the correlation for Germany over each of the three dimensions (Affect, Probability, Consequence)
germany_correlation_dimensions <- df_3_tresh_cleaned_long %>%
  filter(Country_f == "DE") %>%
  group_by(Risk_Dimension_f) %>%
  summarize(correlation = cor(CombinedPoliticalValue, Rating, method = "pearson"), .groups = "drop") %>%
  filter(Risk_Dimension_f %in% c("Affect", "Probs", "Sever"))  # Filter for the three dimensions

# Rename Risk Dimension for better readability for Germany
germany_correlation_dimensions$Risk_Dimension_f <- recode(germany_correlation_dimensions$Risk_Dimension_f,
                                                           "Affect" = "Affect",
                                                           "Probs" = "Probability",
                                                           "Sever" = "Consequence")

# Combine the results for USA and Germany
correlation_comparison <- bind_rows(
  usa_correlation_dimensions %>% mutate(Country = "US"),
  germany_correlation_dimensions %>% mutate(Country = "DE")
)

# View the results
print(correlation_comparison)

```


- Overall Correlation of the Political Scale for USA and Germany, across all Risks and dimensions

USA: A correlation of -0.0099, which is very close to zero. This suggests that there is virtually no linear relationship between political orientation and risk perception in the USA. Political orientation does not seem to have a significant influence on how risky individuals perceive the situations.

Germany: A correlation of 0.0992, which is slightly positive. This indicates a very weak positive relationship between political orientation and risk perception in Germany. While the relationship is still quite weak, it implies that there may be a very slight tendency for political orientation to influence risk perception.

```{r}
# For USA
usa_correlation_all <- df_3_tresh_cleaned_long %>%
  filter(Country_f == "US") %>%
  summarize(correlation = cor(CombinedPoliticalValue, Rating, method = "pearson"))

# For Germany
germany_correlation_all <- df_3_tresh_cleaned_long %>%
  filter(Country_f == "DE") %>%
  summarize(correlation = cor(CombinedPoliticalValue, Rating, method = "pearson"))

# Combine the results for comparison
correlation_comparison_all <- bind_rows(
  usa_correlation_all %>% mutate(Country = "USA"),
  germany_correlation_all %>% mutate(Country = "Germany")
)

# View the results
print(correlation_comparison_all)
```

## Data Preparation for Mixed-Effects Modeling and Data Visualization

The following dataset was restructured to facilitate the implementation of a Mixed-Effects Model, which will be conducted in later analyses.  Specifically, the data were transformed from a wide to a long format to enable the inclusion of different risk perception dimensions (Affect, Probability, and Consequentialist) as separate predictors within the model framework. This transformation was accomplished by selecting variables that contained the terms Affect, Sever, or Probs, representing distinct aspects of risk perception, and applying a pivoting procedure to consolidate them into a single, unified structure.

Furthermore, categorical variables — including education, risk dimension, risk type, and country—were converted into factors. This step ensures their correct specification in the statistical models, allowing for the examination of group differences and interactions (e.g., across educational levels or risk types). These data transformations provide a flexible structure for analyzing how political orientation relates to risk perception across multiple domains and dimensions.

The new dataframe which will be used for mixed effects modeling is called "df_3_tresh_cleaned_long".

# Risk Domain
```{r}
# Create a new variable for the risk domain
df_3_tresh_cleaned_long <- df_3_tresh_cleaned_long %>%
  mutate(Risk_Domain = case_when(
    str_detect(Risk_f, "Vaccination|ViralPandemic|MentHealthProb") ~ "Health",
    str_detect(Risk_f, "SexAssault|GunViol|Terrorism") ~ "Crime",
    str_detect(Risk_f, "ClimateChange|NaturalDisast|NuclPowerPlant") ~ "Nature",
    str_detect(Risk_f, "IllegImmigrat|PolitCorrupt|EconCrisis") ~ "Social/Political",
    TRUE ~ "Other"
  ))

```


```{r}
# Step 1: Convert categorical variables into factors

                                                      
df_3_tresh_cleaned <- df_3_tresh_cleaned %>%
  mutate(
    education = str_trim(education),
    education = factor(education, levels = c("NA", "Other", "No formal school education", "Less than high school", 
                                             "High school diploma", "some college", "Bachelor’s degree", 
                                             "Master’s degree", "Doctoral degree"), ordered = TRUE),
    Country_f = factor(Country),
    CombinedPoliticalValue_f = factor(CombinedPoliticalValue) 
  )

# Step 2: Restructure the data from wide to long format for risk dimensions (Affect, Sever, Probs)
risk_cols <- which(str_detect(colnames(df_3_tresh_cleaned), pattern = "Affect|Sever|Probs"))

df_3_tresh_cleaned_long <- df_3_tresh_cleaned %>% 
  pivot_longer(cols = risk_cols,
               names_to = c("Risk", "Risk_Dimension"),
               values_to = "Rating",
               names_pattern = "(\\w+)(Affect|Sever|Probs)")

# Step 3: Convert variables into a factor
df_3_tresh_cleaned_long <- df_3_tresh_cleaned_long %>%
  mutate(Risk_Dimension_f = factor(Risk_Dimension),
         Risk_f = factor(Risk),
         Country_f = factor(Country), 
          Risk_Domain = case_when(
           str_detect(Risk_f, "Vaccination|ViralPandemic|MentHealthProb") ~ "Health",
           str_detect(Risk_f, "SexAssault|GunViol|Terrorism") ~ "Crime",
           str_detect(Risk_f, "ClimateChange|NaturalDisast|NuclPowerPlant") ~ "Nature",
           str_detect(Risk_f, "IllegImmigrat|PolitCorrupt|EconCrisis") ~ "Social/Political",
           TRUE ~ "Other"
         ),
         Risk_Domain_f = factor(Risk_Domain, levels = c("Health", "Crime", "Nature", "Social/Political", "Other"))
  )
```

## Political Ideology and Gender (Mann-Whitney-Test / T-test)

- Germany:
In Germany, females have a higher average political ideology score of 5.36, compared to males at 5.07. The standard deviation for females is 2.08, while for males, it's 2.06, indicating similar variability in responses between genders.


- United States:
In the United States, males have a higher average score of 5.79, while females have a lower average of 5.21. The standard deviation for males is 2.63, and for females, it's 2.69, suggesting a bit more variability in the female responses.


```{r, fig.width=12, fig.height=8}

# Calculate mean, median, and standard deviation by gender and country
gender_summary <- df_3_tresh_cleaned %>%
  filter(!is.na(gender), !is.na(CombinedPoliticalValue)) %>%  # Remove missing values
  group_by(Country, gender) %>%
  summarise(
    mean_value = mean(CombinedPoliticalValue, na.rm = TRUE),
    median_value = median(CombinedPoliticalValue, na.rm = TRUE),
    sd_value = sd(CombinedPoliticalValue, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  arrange(Country, mean_value)  # Sort by country and mean ideology score

# Print the results
print(gender_summary)

# boxplot gender
ggplot(df_3_tresh_cleaned %>%
         filter(gender %in% c("Male", "Female"), !is.na(CombinedPoliticalValue), Country %in% c("US", "DE")), 
       aes(x = gender, y = CombinedPoliticalValue, fill = gender)) +
  geom_boxplot() +
  facet_wrap(~ Country) +  # Separate Panels for US and DE
  labs(title = "Distribution of Political Ideology by Gender",
       x = "Gender",
       y = "Political Ideology Scale (0-10)") +
  theme_minimal() +
  theme(legend.position = "none")

# bar chart gender
ggplot(df_3_tresh_cleaned %>%
         filter(gender %in% c("Male", "Female"), !is.na(CombinedPoliticalValue), Country %in% c("US", "DE")) %>%
         group_by(Country, gender) %>%
         summarise(
           mean_value = mean(CombinedPoliticalValue, na.rm = TRUE),
           sd_value = sd(CombinedPoliticalValue, na.rm = TRUE),
           .groups = "drop"
         ), 
       aes(x = gender, y = mean_value, fill = gender)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(ymin = mean_value - sd_value, ymax = mean_value + sd_value), width = 0.2) +
  facet_wrap(~ Country) +
  labs(title = "Mean Political Ideology Score by Gender",
       x = "Gender",
       y = "Mean Political Ideology Scale (±SD)")  +
  scale_y_continuous(limits = c(0, 10)) +  # Set y-axis from 0 to 10
  theme_minimal() +
  theme(legend.position = "none")
```


## Shapiro-Wilk and Levene Test (check normal distribution and Variance homogeneity per gender)

The p-values for all groups (Germany & USA, Male & Female) were p < 0.05. This means that the political ideology scores are not normally distributed in any group.

Since the normality assumption is violated, but the variance assumption holds, the t-test is not suitable. 
Instead, the Mann-Whitney U test (Wilcoxon rank-sum test) could be used to compare political ideology scores between genders.
```{r}

# Germany
shapiro.test(df_3_tresh_cleaned$CombinedPoliticalValue[df_3_tresh_cleaned$Country == "DE" & df_3_tresh_cleaned$gender == "Male"])
shapiro.test(df_3_tresh_cleaned$CombinedPoliticalValue[df_3_tresh_cleaned$Country == "DE" & df_3_tresh_cleaned$gender == "Female"])

# USA
shapiro.test(df_3_tresh_cleaned$CombinedPoliticalValue[df_3_tresh_cleaned$Country == "US" & df_3_tresh_cleaned$gender == "Male"])
shapiro.test(df_3_tresh_cleaned$CombinedPoliticalValue[df_3_tresh_cleaned$Country == "US" & df_3_tresh_cleaned$gender == "Female"])

# Germany
leveneTest(CombinedPoliticalValue ~ gender, data = df_3_tresh_cleaned %>% filter(Country == "DE"))

# USA
leveneTest(CombinedPoliticalValue ~ gender, data = df_3_tresh_cleaned %>% filter(Country == "US"))

```
## Mann-Whitney-Test: Political Ideology and Gender

- Germany:
W = 338202, p = 0.00175 (p < 0.05)
Significant difference, women in Germany tend to have a higher political ideology score than men.


- USA:
W = 286739, p = 5.234 × 10⁻⁶ (p < 0.05)
Significant difference, men in the US tend to have a higher political ideology score than women.

```{r}

# Mann-Whitney-Test Germany
wilcox.test(CombinedPoliticalValue ~ gender, data = df_3_tresh_cleaned %>%
             filter(Country == "DE", gender %in% c("Male", "Female")))

# Mann-Whitney-Test USA
wilcox.test(CombinedPoliticalValue ~ gender, data = df_3_tresh_cleaned %>%
             filter(Country == "US", gender %in% c("Male", "Female")))

```

## T-Test: Political Ideology and Gender (not suitable)

The t-test results for Germany indicate a statistically significant difference in political ideology scores 
between women and men (t = 2.7191, p = 0.00662). Women have a higher mean score (5.36) compared to men (5.07), with a 95% confidence interval of 0.0791 to 0.4885.

The t-test results for the United States indicate a statistically significant difference in political ideology scores between women and men (t = -4.3617, p = 1.38 × 10⁻⁵). Men have a higher mean score (5.79) compared to women (5.21), with a 95% confidence interval ranging from -0.8385 to -0.3183.
```{r}

# t-Test for germany
t_test_de <- t.test(CombinedPoliticalValue ~ gender, data = df_3_tresh_cleaned %>%
                     filter(Country == "DE", gender %in% c("Male", "Female")))

# t-Test for USA
t_test_us <- t.test(CombinedPoliticalValue ~ gender, data = df_3_tresh_cleaned %>%
                     filter(Country == "US", gender %in% c("Male", "Female")))

# results
t_test_de
t_test_us

```


## Political Ideology and Age (Kruskal-Wallis Test / ANOVA)

Here is an ordered list of mean political ideology scores by age group for both countries (from lowest to highest):

- Germany:
18–29: 4.83 (lowest)
75+: 5.15
60–74: 5.25
45–59: 5.25
30–44: 5.32 (highest)

In Germany, the differences between age groups are relatively small, with the youngest group (18–29) showing the lowest value and 30–44 having the highest mean.

- United States:
18–29: 4.85* (lowest)
30–44: 5.26
45–59: 5.54
60–74: 5.54
75+: 5.79* (highest)

In the United States, there is a clearer trend of increasing scores with age, with the oldest group (75+) showing the highest value.

Younger respondents (18–29) in both countries tend to have slightly lower scores, suggesting a slightly more left-leaning orientation compared to older age groups.
The U.S. exhibits a stronger age-related shift toward higher (more conservative/right-wing) values compared to Germany.

```{r, fig.width=12, fig.height=8}

df_3_tresh_cleaned <- df_3_tresh_cleaned %>%
  mutate(AgeGroup = case_when(
    age >= 18 & age <= 29 ~ "18-29",
    age >= 30 & age <= 44 ~ "30-44",
    age >= 45 & age <= 59 ~ "45-59",
    age >= 60 & age <= 74 ~ "60-74",
    age >= 75 ~ "75+"
  ))


# mean and median Political Ideology by Age Group
df_3_tresh_cleaned %>%
  filter(!is.na(CombinedPoliticalValue)) %>%
  group_by(Country, AgeGroup) %>%
  summarise(
    mean_value = mean(CombinedPoliticalValue, na.rm = TRUE),
    median_value = median(CombinedPoliticalValue, na.rm = TRUE),
    sd_value = sd(CombinedPoliticalValue, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  arrange(Country, AgeGroup) %>%
  print()


#boxplot of political ideology by age group
df_3_tresh_cleaned %>%
  filter(!is.na(CombinedPoliticalValue)) %>%
  ggplot(aes(x = AgeGroup, y = CombinedPoliticalValue, fill = AgeGroup)) +
  geom_boxplot() +
  facet_wrap(~ Country) +
  labs(title = "Distribution of Political Ideology by Age Group",
       x = "Age Group",
       y = "Political Ideology Scale") +
  theme_minimal()


```
## Shapiro-Wilk-Test and Levene-Test (check normal distribution and Variance homogeneity per age groups)

The results of the Shapiro-Wilk test show that political ideology is not normally distributed in all age groups (all p-values are significant < 0.05), and the Levene test confirms that the variances between the groups are homogeneous (p-value = 0.1062). Due to the violation of the normal distribution assumption, the ANOVA is not suitable, as it assumes normal distribution; instead, the Kruskal-Wallis test is the better choice, as it makes no assumption about the distribution of the data and is more reliable for non-normally distributed data.

```{r}

# Shapiro-Wilk test for normal distribution (for each age group)
shapiro_results <- df_3_tresh_cleaned %>%
  filter(!is.na(AgeGroup), !is.na(CombinedPoliticalValue)) %>%
  group_by(AgeGroup) %>%
  summarise(shapiro_p_value = shapiro.test(CombinedPoliticalValue)$p.value)

print(shapiro_results)

# Levene test for homogeneity of variances
levene_test <- leveneTest(CombinedPoliticalValue ~ AgeGroup, data = df_3_tresh_cleaned)
print(levene_test)

```

## Kruskal-Wallis test: Political Ideology and Age

Germany:

Chi-square = 4.1058, df = 4, p-value = 0.3919

Since the p-value is > 0.05, there is no significant difference in political ideology between the age groups in Germany.
This means that the age groups have similar distributions of political ideology.

USA:

Chi-square = 13.263, df = 4, p-value = 0.01006
Since the p-value is < 0.05, there are significant differences in political ideology between the age groups in the USA.
This means that at least one age group differs significantly from another in its political orientation.
In the US, there are generally no strong age differences in political ideology - except between the youngest age group (18-29) and the oldest (75+), which differ significantly.

```{r}
# Kruskal-Wallis-Test Germany
kruskal_de <- kruskal.test(CombinedPoliticalValue ~ AgeGroup, 
                           data = df_3_tresh_cleaned %>% filter(Country == "DE"))
print(kruskal_de)

# Kruskal-Wallis-Test USA
kruskal_us <- kruskal.test(CombinedPoliticalValue ~ AgeGroup, 
                           data = df_3_tresh_cleaned %>% filter(Country == "US"))
print(kruskal_us)

# Post-hoc pairwise Wilcoxon tests for the USA (only if Kruskal-Wallis was significant)
pairwise_us <- pairwise.wilcox.test(df_3_tresh_cleaned$CombinedPoliticalValue[df_3_tresh_cleaned$Country == "US"], 
                                    df_3_tresh_cleaned$AgeGroup[df_3_tresh_cleaned$Country == "US"], 
                                    p.adjust.method = "bonferroni")

print(pairwise_us)

```

# ANOVA: Political Ideology and Age (not suitable)

- ANOVA results:

Germany: 
F value: 1.766
p-value: 0.133
This p-value is greater than 0.05 (p = 0.133), indicating that there are no significant differences in political ideology scores across the age groups in Germany. 

USA: 
F value: 3.591
p-value: 0.00637
This p-value is less than 0.05 (p = 0.00637), indicating that there are significant differences in political ideology scores across the age groups in the United States.

```{r}
# ANOVA for Political Ideology by Age Group for Germany
anova_de <- aov(CombinedPoliticalValue ~ AgeGroup, data = df_3_tresh_cleaned %>% filter(Country == "DE"))
summary(anova_de)

# ANOVA for Political Ideology by Age Group for the United States
anova_us <- aov(CombinedPoliticalValue ~ AgeGroup, data = df_3_tresh_cleaned %>% filter(Country == "US"))
summary(anova_us)

```

## Political Ideology and Education

Here are the seven education levels and their average political orientation. Listed from lowest to highest.

- Germany:
No formal school education: 4.58
Master’s degree:	5.04
Less than high school:	5.20	
Bachelor’s degree:	5.24
High school diploma:	5.29	
some college:	5.40	
Doctoral degree: 5.54

- USA:
Doctoral degree:	4.68
Less than high school:	5.02
No formal school education:	5.30	
Bachelor’s degree: 5.32
some college:	5.37	
Master’s degree:	5.53
High school diploma:	5.74

```{r, fig.width=12, fig.height=8}

# Calculate mean, median, and standard deviation by education level and country
education_summary <- df_3_tresh_cleaned %>%
  filter(!is.na(education), !is.na(CombinedPoliticalValue)) %>%  # Remove missing values
  group_by(Country, education) %>%
  summarise(
    mean_value = mean(CombinedPoliticalValue, na.rm = TRUE),
    median_value = median(CombinedPoliticalValue, na.rm = TRUE),
    sd_value = sd(CombinedPoliticalValue, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  arrange(Country, mean_value)  # Sort by country and mean ideology score

# Print the results
print(education_summary)

# boxplot education
ggplot(df_3_tresh_cleaned %>%
         filter(!is.na(education), !is.na(CombinedPoliticalValue), Country %in% c("US", "DE")), 
       aes(x = education, y = CombinedPoliticalValue, fill = education)) +
  geom_boxplot() +
  facet_wrap(~ Country) +  # Separate Panels for US and DE
  labs(title = "Distribution of Political Ideology by Education Level",
       x = "Education Level",
       y = "Political Ideology Scale (0-10)") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels

# bar chart education
ggplot(df_3_tresh_cleaned %>%
         filter(!is.na(education), !is.na(CombinedPoliticalValue), Country %in% c("US", "DE")) %>%
         group_by(Country, education) %>%
         summarise(
           mean_value = mean(CombinedPoliticalValue, na.rm = TRUE),
           sd_value = sd(CombinedPoliticalValue, na.rm = TRUE),
           .groups = "drop"
         ), 
       aes(x = education, y = mean_value, fill = education)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(ymin = mean_value - sd_value, ymax = mean_value + sd_value), width = 0.2) +
  facet_wrap(~ Country) +
  labs(title = "Mean Political Ideology by Education Level",
       x = "Education Level",
       y = "Mean Political Ideology Score") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  # Rotate x-axis labels
  ylim(0, 10)  # Set y-axis limits to 10

```

## Levene Test (check Variance homogeneity for education)

p-value = 1.358e-06 (p < 0.05)
Variances are not equal

The variances between the 7 education levels are significantly different, which means that ANOVA is not suitable.
Since the Levene test shows that the variances are not homogeneous (p < 0.05), I will use the Kruskal-Wallis test, as this makes no assumption about the homogeneity of the variances.

```{r}
leveneTest(CombinedPoliticalValue ~ education, data = df_3_tresh_cleaned)

```

## Kruskal-Wallis test: Political Ideology and Education

chi-squared = 11.171, df = 6, p-value = 0.08323

The p-value of 0.08323 is greater than 0.05, which indicates that there is no significant difference in political orientation between the different levels of education.

```{r}
# 2. Kruskal-Wallis-Test
kruskal.test(CombinedPoliticalValue ~ education, data = df_3_tresh_cleaned)

```


```{r}


```


```{r}


```


# Age Group

The age groups in the dataset were categorized as follows: "18-29 years," "30–44 years," "45–59 years," "60–74 years," and "75+ years." 
These categories help to group participants into meaningful age ranges for better understanding and analysis. The distribution of participants across these age groups was examined separately for the US and Germany, and the number of distinct participants in each age group was counted and visualized. This segmentation allows for a clear comparison of age demographics across the two countries in the study.
```{r}
# Create the age group variable
df_3_tresh_cleaned_long <- df_3_tresh_cleaned_long %>%
  mutate(age_group = case_when(
    age >= 18 & age <= 29 ~ "18-29",
    age >= 30 & age <= 44 ~ "30-44",
    age >= 45 & age <= 59 ~ "45-59",
    age >= 60 & age <= 74 ~ "60-74",
    age >= 75 ~ "75+"
  ))


# Count distinct participants per age group, separated by Country (US and DE)
age_group_counts_by_country <- df_3_tresh_cleaned_long %>%
  group_by(Country, age_group) %>%
  summarise(distinct_participants = n_distinct(id))

# Display the counts for each country and age group
print(age_group_counts_by_country)

# Visualize the distribution with the raw numbers above the bars
ggplot(age_group_counts_by_country, aes(x = age_group, y = distinct_participants, fill = Country)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = distinct_participants), position = position_dodge(width = 0.9), vjust = -0.5) +  # Add raw counts above the bars
  labs(title = "Distribution of Age Groups by Country (Number of Participants)", 
       x = "Age Group", y = "Number of Distinct Participants") +
  theme_minimal()

```

# Education Group
```{r}
# Create the education group variable with 'Other' for missing or unclassified data
df_3_tresh_cleaned_long <- df_3_tresh_cleaned_long %>%
  mutate(education_group = factor(case_when(
    education %in% c("No formal school education", "Less than high school") ~ "Low",
    education %in% c("High school diploma", "some college") ~ "Middle",
    education %in% c("Bachelor’s degree", "Master’s degree", "Doctoral degree") ~ "High",
    TRUE ~ "Other"  # Label missing or unclassified data as 'Other'
  ), levels = c("Low", "Middle", "High", "Other")))  # Include 'Other' in the factor levels

# Count distinct participants per education group, separated by Country (US and DE)
education_group_counts_by_country <- df_3_tresh_cleaned_long %>%
  group_by(Country, education_group) %>%
  summarise(distinct_participants = n_distinct(id))

# Display the counts for each country and education group
print(education_group_counts_by_country)

# Visualize the distribution with the raw numbers above the bars
ggplot(education_group_counts_by_country, aes(x = education_group, y = distinct_participants, fill = Country)) +
  geom_bar(stat = "identity", position = "dodge") +
  geom_text(aes(label = distinct_participants), position = position_dodge(width = 0.9), vjust = -0.5) +  # Add raw counts above the bars
  labs(title = "Distribution of Education Groups by Country (Number of Participants)", 
       x = "Education Group", y = "Number of Distinct Participants") +
  theme_minimal()


```


## Mixed Effects Modelling:

I will first work with the data from the USA (N = 1581).

```{r}

# first create individual dataframes for each country

df_3_tresh_cleaned_long_us <- df_3_tresh_cleaned_long %>% filter(Country_f == "US")
df_3_tresh_cleaned_long_de <- df_3_tresh_cleaned_long %>% filter(Country_f == "DE")

```

## Description and Goal of the Mixed-Effects Model

I am going to use a linear mixed-effects model to analyze how political orientation (Combined Political Value) influences people's risk ratings (Rating) for different risks (Risk_f), considering risk dimensions (Risk_Dimension_f) and other demographic factors (gender, age, education). It also accounts for random effects to handle the hierarchical nature of our data.

What is being measured?
The model tests whether the overall political orientation (Combined Political Value) influences risk perception (Rating) across all risks.

Interaction Between Political Orientation and Risk Dimensions: It tests whether the effect of political orientation on risk perception varies by risk dimension (e.g., Affect, Probability, Consequence). For instance, does political orientation influence how people perceive risks related to emotional reactions differently than risks related to probability or consequences?

An important point is also the interaction between Political Orientation and the specific Risks. The model also tests if political orientation affects the perception of each individual risk differently. This is done through the interaction term CombinedPoliticalValue:Risk_f. For example, does political orientation influence perceptions of climate change differently than perceptions of economic crisis?

Control for demographics: The model includes gender, age, and education to control for their effects on risk perception. These variables are treated as fixed effects, meaning their influence is assumed to be the same across all participants.

## Description of Model 1

In the next section I will briefly explain which effects I include in model 1 and why. I will now shortly describe my approach. In the next step, I will try to optimize the model in order to achieve the best possible fit without making the mixed-effects model too complex. I will pay particular attention to avoiding multicollinearity and keeping the model simple and interpretable.

Fixed Effects:
Fixed effects represent variables that have a constant influence on the dependent variable (in this case, Rating) across all participants.

- CombinedPoliticalValue: Tests the main effect of political orientation on the overall risk perception.

- Risk_Dimension_f: Tests the main effect of risk dimension (e.g., Affect, Probability, Consequence) on the overall risk perception.

- CombinedPoliticalValue * Risk_Dimension_f: Tests whether the effect of political orientation varies by risk dimension. This is an interaction term.

- CombinedPoliticalValue:Risk_f: Tests whether the effect of political orientation varies by specific risks (e.g., climate change, nuclear power plant). This is also an interaction term.

- gender, age, education: These are control variables to account for demographic differences in risk perception. They test the influence of gender, age, and education on the ratings, independently of political orientation and risk dimensions.

Random Effects:
Random effects represent random variability that can be accounted for by the model to handle the clustered nature of the data (multiple ratings from the same person).

- (1 | id): This term accounts for the fact that each participant (id) may have their own baseline level of risk perception. People might generally rate all risks higher or lower than others, and this random effect allows for that individual variability in their  ratings.



## Interpretation of Model 1:

- REML-criterion: 292537.4
Random effects:
- id (intercept) Variance: 3.575
There seem to be substantial individual differences between the participants.
- residual variance: 7.328
This indicates that a large part of the variability remains unexplained.


Fixed effects:

Political orientation and general risk perception:

- Combined Political Value: -0.06608, p < .001 (the effect is significant)
The negative estimate means that the average risk perception decreases with increasing political orientation (more on the right/conservative end).

Influence of the risk dimensions: (Affect dimension as reference)

- Risk Dimension "Probability" (-1.121, p < .001): Perceived riskiness is on average lower than on the Affect dimension
- Risk Dimension "Consequence"(+0.8759, p < .001): Perceived riskiness of a risk is rated higher than on the Affect dimension

Interactions of the dimensions with political orientation:

- Combined Political Value: Risk Dimension Consequence (+0.033, p = .0011): More conservative people rate the severity of a risk slightly higher compared to the Affect dimension.
- Combined Political Value: Risk Dimension Probability (not significant): Political orientation does not appear to have a strong influence on the perception of risk in this dimension compared to the Affect Dimension.

Influence of political orientation on specific risks: (Climate Change as reference)

Here is the ranking of the risks according to the greatest influence of political orientation on risk perception, based on the estimates of the interaction terms between political orientation and the individual risks. The risks with the strongest positive influence on risk perception due to political orientation are at the top:

1. Economic crisis (+0.209, p < .001): People with higher scores on the political scale (more right/conservative) perceive this risk as                                       a greater risk than climate change.

2. Political corruption (+0.121, p < .001): People with higher scores on the political scale (more right/conservative) perceive this                                               risk as a greater risk than climate change.

3. Natural disasters (+0.110, p < .001): People with higher scores on the political scale (more right/conservative) perceive this risk                                          as a greater risk than climate change.

4. Terrorism (+0.086, p < .001): People with higher scores on the political scale (more right/conservative) perceive this risk as                                       a greater risk than climate change.

5. Pandemics (+0.041, p < .001): People with higher scores on the political scale (more right/conservative) perceive this risk as                                       a greater risk than climate change.

6. Gun violence (+0.101, p < .001): People with higher scores on the political scale (more right/conservative) perceive this risk as                                       a greater risk than climate change.

7. Illegal immigration (+0.038, p < .001): People with higher scores on the political scale (more right/conservative) perceive this                                               risk as a greater risk than climate change.

8. Mental illness (+0.057, p < .001): People with higher scores on the political scale (more right/conservative) perceive this risk as                                       a greater risk than climate change.

9. Nuclear power (-0.059, p < .001): People with higher scores on the political scale (more right/conservative) perceive this risk as                                       a lower risk than climate change.

10. Sexual violence (-0.023, p = .008): People with higher scores on the political scale (more right/conservative) perceive this risk                                          as a lower risk than climate change.

11. Vaccinations (-0.068, p < .001): People with higher scores on the political scale (more right/conservative) perceive this risk as                                       a lower risk than climate change.



Demographic factors:

Men (-0.801, p < .001): Men perceive risks to be lower overall.

Age (-0.01886, p < .001): Older people rate risks lower.

Education: Hardly any significant effects, but a slightly negative trend (higher education means slightly lower risk perception).

## Key Insights for Political Orientation

The climate change risk is used as a reference because, according to the literature, a lower value of risk perception can be expected for people who have higher values in political orientation. This could therefore be a good reference point for comparing it with other risks.

All 11 risks show a significant effect of political orientation on risk perception. Most interaction effects are positive, which means that a higher value in political orientation is associated with a stronger risk perception (except for nuclear power plants, sexual assault and vaccinations, where the effect is negative).

This means if for most other risks a higher value on political orientation are associated with a stronger risk perception, it could be that climate change is perceived as less risky, especially among people with higher values in political orientation.

```{r}
# Model 1

# Mixed-Effects-Modell for political orientation, dimension und control variables
model1 <- lmer(Rating ~ CombinedPoliticalValue * Risk_Dimension_f + 
              CombinedPoliticalValue:Risk_f + 
              gender + age + education + 
              (1 | id), 
              data = df_3_tresh_cleaned_long_us)
# results
summary(model1)
```

# Model 2: Adding "Risk" as a random effect

For model 2 I am going to add "Risk_f" (12 risks). Adding "Risk_f" as a random effect could help to account for differences in how risks are rated, since some risks are seen as more serious than others. It also controls for repeated measurements, since each person rated multiple risks, making the data dependent.

The variance of the random effect for Risk_f is 1.911, indicating some variation associated with this random effect. 

To have a look at whether this model benefits from adding this random effect, I will perform a likelihood ratio test (LRT) to check whether the model 2 performs better with this random effect.

REML criterion: 289749.1
```{r}
# model 2, adding risk as a random effect
model2 <- lmer(Rating ~ CombinedPoliticalValue * Risk_Dimension_f + 
              CombinedPoliticalValue:Risk_f + 
              gender + age + education + 
              (1 | id) + (1 | Risk_f), 
              data = df_3_tresh_cleaned_long_us)
#results
summary(model2)
```

## Likelihood ratio test (LRT): Model Comparison between Model 1 and Model 2 (adding random effect (1 | Risk_f))

I will now perform a Likelihood Ratio Test (LRT) to see if adding the additional random effect to the model significantly improves its performance.

The test statistic for the LRT is:
LRT=-2×(log-likelihood of the simple model-log-likelihood of the more complex model)
LRT=-2×(log-likelihood of the simple model-log-likelihood of the more complex model)

The greater the difference between the models, the more likely it is that the more complex model actually provides a better fit to the data. Therefore, a significant result indicates that the more complex model provides a significantly better fit.

- Results:

AIC & BIC: Model 2 has lower AIC (289678 vs. 292443) and BIC (289938 vs. 292695), indicating a better model fit.

Likelihood-Ratio Test: The extremely low p-value (< 0.001) shows that the model 2 with the additional random effect (1 | Risk_f) is significantly better than the model without this effect. 
- Model 2 is significantly better than Model 1 (χ² = 2767.1, df = 1, p < 2.2 × 10⁻¹⁶).

Conclusion: The random effect (1 | Risk_f) significantly improves the model. The model fit improves with this adjustment, showing that risk type should be included.

So we will now continue with model 2 and keep trying to optimize it.

```{r}
# Likelihood-Ratio-Test 
anova(model1, model2)

```

# Model 3: Adding "political orientation" as a random effect

It is now taken into account that the assessment can differ systematically depending on the risk area and political orientation.
This makes the model more flexible by allowing random deviations for political orientation and risk areas.


This model with the additional random effect has a slightly lower REML criterion (289563.1 vs. 289749.1). This means that the model with the additional random effect fits the data structure better.

The residual variance decreases slightly (from 6.976 to 6.936) which means the additional random effect minimally reduces the unexplained variance.

The variance for the random effect of Combined Political Value (0.4984) is relatively small compared to the other random effects like id: 3.8323 or Risk_f: 1.9112. This means that although the influence of political orientation exists as a random effect, it is not very strong. So I am going to do another Likelihood Test to compare model 2 to model 3.

```{r}
#Model 3
model3 <- lmer(Rating ~ CombinedPoliticalValue * Risk_Dimension_f + 
              CombinedPoliticalValue:Risk_f + 
              gender + age + education + 
              (1 | id) + (1 | Risk_f) + (1 | CombinedPoliticalValue), 
              data = df_3_tresh_cleaned_long_us)
#summary
summary(model3)
```

## Likelihood ratio test (LRT): Model Comparison between Model 2 and Model 3

Model 3 (with Combined Political Value as a random effect) has lower AIC and BIC, suggesting it fits the data better than Model 2.
Likelihood-Ratio Test: χ² = 182.46, df = 1, p < 2.2 × 10⁻¹

Conclusion: The very small p-value indicates that Model 3 (adding (1 | CombinedPoliticalValue) as a random effect) is significantly better than Model 2.

```{r}
anova(model2, model3)

```
# Model 4: Adding "Risk Domain"

Now I add Risk_Domain_f as a fixed effect. So far, I have only considered the dimensions of risk (Risk_Dimension_f), but not whether it is a health, nature, crime or social/political risk.

The REML criterion is lower for model 4 (287986.6) than for model 3 (289563.1).

But, I am afraid that Risk_Domain_f correlates strongly with Risk_f or Risk_Dimension_f, which could lead to multicollinearity problems. 
I now get the warning "fixed-effect model matrix is rank deficient so dropping 3 columns / coefficients". This is a sign that model 4 contains multicollinearity.

I will check this with the Generalised Variance Inflation Factor (GVIF). For this, library(car) is needed.


```{r}
model4 <- lmer(Rating ~ CombinedPoliticalValue * Risk_Dimension_f * Risk_Domain_f + 
              CombinedPoliticalValue:Risk_f + 
              gender + age + education + 
              (1 | id) + (1 | Risk_f) + (1 + CombinedPoliticalValue), 
              data = df_3_tresh_cleaned_long_us)
              
summary(model4)

```

## Likelihood ratio test (LRT): Model Comparison between Model 3 and Model 4

Actually, model 4 fits better, based on the AIC/BIC values and the likelihood ratio test with the significant p value, despite the warning of multicollinearity.
Since the warning (‘rank deficient so dropping 3 columns’) means that some predictors correlate perfectly or almost perfectly with others and have therefore been removed from the model, this is very impractical for my interpretation as not all interactions of political orientation with the risks are shown. So model 3 would be better for me to interpret.

```{r}

anova(model3, model4)
```
## Generalised Variance Inflation Factor (GVIF): Model 3 and Model 4

A GVIF around 5 or higher indicate strong multicollinearity, which can be problematic and values of more than 10 (in unnormalised form) indicates problematic multicollinearity, but for the normalised values (GVIF^(1/(2*Df)) a threshold of 1.2 or higher is usually considered potentially problematic.

- Model 3:

Problematic multicollinearity: Only the two variables "Risk_Dimension_f" and the interaction "Combined Political Value:Risk_Dimension_f" have high GVIF values, especially in the normalised form (GVIF^(1/(2*Df))), which indicates potentially strong correlations and problems with the estimation.
High multicollinearity means that the dimensions of risk perception (Affect, Probability and Consequence) are probably strongly correlated with each other, which could impair the stability and interpretation of the model.

- Model 4:

There are several variables and interactions in the model that have even higher GVIF values. Therefore, it is not helpful to add risk domain in the model, which is why model 3 is preferable.

I have tried other models and even if i remove the risk_dimension effect and replace it with risk_domain, i still get the warning "fixed-effect model matrix is rank deficient so dropping 3 columns / coefficients". So it is probably better not to include the domains in the model.

```{r}
vif(model3)
vif(model4)

```

## Model 3: Only Affective Dimension

Negative Observation: the residual value is higher compared to the model that included all dimensions as well as the REML criterion value.


```{r}
df_3_tresh_cleaned_long_us_affect <- subset(df_3_tresh_cleaned_long_us, Risk_Dimension == "Affect")


model3_affect <- lmer(Rating ~ CombinedPoliticalValue + 
              CombinedPoliticalValue:Risk_f + 
              gender + age + education + 
              (1 | id) + (1 | Risk_f) + (1 | CombinedPoliticalValue), 
              data = df_3_tresh_cleaned_long_us)

summary(model3_affect)
```


## Likelihood ratio test (LRT): Model Comparison between Model 3 and Model 3 (Only Affective Dimension)

Model 3 would be the preferred model, as it offers a better fit to the data and also performs significantly better than model3_affect.
```{r}

anova(model3, model3_affect)
```

## Generalised Variance Inflation Factor (GVIF): Model 3 and Model 3 (Only Affective Dimension)

But if multicollinearity is a problem in model 3 due to the Risk_Dimension_f (with multiple dimensions), then model3_affect might be a better choice as it is focussed on one dimension and has lower GVIF values, which could lead to a more stable estimate.
```{r}
vif(model3)
vif(model3_affect)

```

## Model 3: Only Probability Dimension

```{r}
df_3_tresh_cleaned_long_us_probability <- subset(df_3_tresh_cleaned_long_us, Risk_Dimension == "Probs")


model3_probability <- lmer(Rating ~ CombinedPoliticalValue + 
              CombinedPoliticalValue:Risk_f + 
              gender + age + education + 
              (1 | id) + (1 | Risk_f) + (1 | CombinedPoliticalValue), 
              data = df_3_tresh_cleaned_long_us)

summary(model3_probability)

```

## Model 3: Only Consequence Dimension


```{r}
df_3_tresh_cleaned_long_us_consequence <- subset(df_3_tresh_cleaned_long_us, Risk_Dimension == "Sever")


model3_consequence <- lmer(Rating ~ CombinedPoliticalValue + 
              CombinedPoliticalValue:Risk_f + 
              gender + age + education + 
              (1 | id) + (1 | Risk_f) + (1 | CombinedPoliticalValue), 
              data = df_3_tresh_cleaned_long_us)

summary(model3_consequence)

```

## Mixed Effects Modelling: Germany

I will apply the same model used for the USA data to the German data, including the same effects and parameters from Model 3. Additionally, I will create separate models for the Affect, Probability, and Consequence dimensions to examine the influence of each individual dimension on political orientation.

```{r}
#Model
model3_de <- lmer(Rating ~ CombinedPoliticalValue * Risk_Dimension_f + 
              CombinedPoliticalValue:Risk_f + 
              gender + age + education + 
              (1 | id) + (1 | Risk_f) + (1 | CombinedPoliticalValue), 
              data = df_3_tresh_cleaned_long_de)
#summary
summary(model3_de)

```


## Comparison USA and Germany

-	The political value (Combined Political Value) has a stronger negative effect in the USA compared to Germany.
-	The risk dimensions (especially Probability and Consequence) show significant effects in both countries, but the effects are             generally stronger in Germany.
-	There are differences in the gender effects, with "genderMale" being positive in Germany and negative in the USA.
-	Education levels have stronger significant effects in Germany, particularly for education^4 and education^6.


Now let's have a look at the interaction terms between Combined Political Value and the different Risk factors (CombinedPoliticalValue:Risk_f) to see, how political orientation influences the perception of various risks in both countries.

- Germany vs USA:

Illegal Immigration: Germany: 0.7563 vs USA: 0.7239

Economic Crisis: Germany: 0.4287 vs USA: 0.3045

Gun Violence: Germany: 0.4098 vs USA: 0.2534

Political Corruption: Germany: 0.4191 vs USA: 0.2176

Terrorism: Germany: 0.4497 vs USA: 0.3878

*Vaccination Side Effects: Germany: 0.4802 vs USA: 0.5221

Sexual Assault: Germany: 0.3614 vs USA: 0.3147

Viral Pandemic: Germany: 0.2845 vs USA: 0.2271

*Natural Disasters: Germany: 0.2711 vs USA: 0.3212

*Nuclear Power Plant: Germany: 0.2639 vs USA: 0.3360

Mental Health Problems: Germany: 0.3280 vs USA: 0.2759


Conclusion:

Political orientation has a greater influence on risk perception in Germany, particularly for risks related to economic crises, gun violence, political corruption, and terrorism, where the interaction effects are noticeably stronger in Germany than in the USA.

However, for vaccination and viral pandemic, the effect is actually slightly stronger in the USA, indicating that political orientation may have a somewhat greater impact on these particular risks in the USA. Still, overall, the political influence is more pronounced in Germany for most risk factors.

This suggests that in Germany, political orientation plays a more substantial role in shaping how different risks are perceived compared to the USA.

(Test)
```{r}
#Model
modelx <- lmer(Rating ~ CombinedPoliticalValue * Risk_Dimension_f:Risk_f + 
              CombinedPoliticalValue:Risk_f + 
              gender + age + education + 
              (1 | id) + (1 | Risk_f) + (1 | CombinedPoliticalValue), 
              data = df_3_tresh_cleaned_long_de)
#summary
summary(modelx)

```

```{r}
# Erstelle einen Dataframe mit den Werten
data <- data.frame(
  Thema = c("Illegal Immigration", "Economic Crisis", "Gun Violence", "Political Corruption", "Terrorism", 
            "Vaccination Side Effects", "Sexual Assault", "Viral Pandemic", 
            "Natural Disasters", "Nuclear Power Plant", "Mental Health Problems"),
  Deutschland = c(0.7563, 0.4287, 0.4098, 0.4191, 0.4497, 0.4802, 0.3614, 0.2845, 0.2711, 0.2639, 0.3280),
  USA = c(0.7239, 0.3045, 0.2534, 0.2176, 0.3878, 0.5221, 0.3147, 0.2271, 0.3212, 0.3360, 0.2759)
)

# Berechne die Differenz Deutschland - USA
data$Differenz <- data$Deutschland - data$USA

# Erstelle einen Plot
ggplot(data, aes(x = Thema, y = Differenz)) +
  geom_bar(stat = "identity", fill = ifelse(data$Differenz > 0, "blue", "red")) +
  coord_flip() +  # Dreh den Plot, damit die Themen besser lesbar sind
  theme_minimal() +
  labs(title = "Differenz zwischen Deutschland und USA in verschiedenen Themen",
       x = "Thema",
       y = "Differenz (Deutschland - USA)") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Neige die Achsenbeschriftungen

```


## Categorisation into Political Groups

I use a data-based categorization since the distribution of political orientation in Germany and the USA is slightly different. I am going to divide the continuous political self-assessment (0-10) into three groups using the quartiles within each nation: Left (lowest quartile), Centre (middle quartile) and Right (highest quartile). This method ensures that the size of each political group is roughly equal and that variations in the distribution between nations (a slight polarisation can be seen in the USA sample, more people have assigned themselves to the extreme values 0 and 10) are taken into account.


- Categorisation for Germany:

Left: Values up to 4 (everything below the 25% quartile)

Centre: Values from > 4 to 6.5 (between the 25% and 75% quartile)

Right: Values > 6.5 (everything above the 75% quartile)


- Categorisation for the USA:

Left: Values up to 4 (everything below the 25% quartile)

Centre: Values from > 4 to 7.5 (between the 25% and 75% quartile)

Right: Values > 7.5 (everything above the 75% quartile)

```{r}
df_3_tresh_cleaned_long %>%
  group_by(Country) %>%
  summarise(
    quartile_25 = quantile(CombinedPoliticalValue, probs = 0.25, na.rm = TRUE),
    quartile_50 = quantile(CombinedPoliticalValue, probs = 0.50, na.rm = TRUE),
    quartile_75 = quantile(CombinedPoliticalValue, probs = 0.75, na.rm = TRUE)
  )
```

## Visualisation of the Distribution of the Political Orientation with Quartile Cutoffs

```{r}
ggplot(df_3_tresh_cleaned_long, aes(x = CombinedPoliticalValue, fill = Country)) +
  geom_histogram(bins = 20, alpha = 0.7, position = "identity", color = "black") +
  geom_vline(data = df_3_tresh_cleaned_long %>% 
               group_by(Country) %>%
               summarise(
                 quartile_25 = quantile(CombinedPoliticalValue, probs = 0.25, na.rm = TRUE),
                 quartile_50 = quantile(CombinedPoliticalValue, probs = 0.50, na.rm = TRUE),
                 quartile_75 = quantile(CombinedPoliticalValue, probs = 0.75, na.rm = TRUE)
               ), 
             aes(xintercept = quartile_25), color = "red", linetype = "dashed") +  # 25% Quartil
  geom_vline(data = df_3_tresh_cleaned_long %>% 
               group_by(Country) %>%
               summarise(
                 quartile_25 = quantile(CombinedPoliticalValue, probs = 0.25, na.rm = TRUE),
                 quartile_50 = quantile(CombinedPoliticalValue, probs = 0.50, na.rm = TRUE),
                 quartile_75 = quantile(CombinedPoliticalValue, probs = 0.75, na.rm = TRUE)
               ), 
             aes(xintercept = quartile_50), color = "blue", linetype = "dashed") +  # Median (50% Quartil)
  geom_vline(data = df_3_tresh_cleaned_long %>% 
               group_by(Country) %>%
               summarise(
                 quartile_25 = quantile(CombinedPoliticalValue, probs = 0.25, na.rm = TRUE),
                 quartile_50 = quantile(CombinedPoliticalValue, probs = 0.50, na.rm = TRUE),
                 quartile_75 = quantile(CombinedPoliticalValue, probs = 0.75, na.rm = TRUE)
               ), 
             aes(xintercept = quartile_75), color = "darkgreen", linetype = "dashed") +  # 75% Quartil
  facet_wrap(~Country) +
  labs(title = "Political Orientation Distribution by Country with Quartile Cutoffs",
       x = "Political Orientation (0-10)", y = "Frequency") +
  theme_minimal()

```

Now I going to do the categorisation into the political groups.
```{r}
df_3_tresh_cleaned_long <- df_3_tresh_cleaned_long %>%
  mutate(
    PoliticalGroup = case_when(
      Country == "DE" & CombinedPoliticalValue <= 4    ~ "Left",    
      Country == "DE" & CombinedPoliticalValue <= 6.5  ~ "Center",  
      Country == "DE" & CombinedPoliticalValue > 6.5   ~ "Right",   

      Country == "US" & CombinedPoliticalValue <= 4    ~ "Left",    
      Country == "US" & CombinedPoliticalValue <= 7.5  ~ "Center",  
      Country == "US" & CombinedPoliticalValue > 7.5   ~ "Right"  
    )
  )

df_3_tresh_cleaned <- df_3_tresh_cleaned %>%
  mutate(
    PoliticalGroup = case_when(
      Country == "DE" & CombinedPoliticalValue <= 4    ~ "Left",    
      Country == "DE" & CombinedPoliticalValue <= 6.5  ~ "Center",  
      Country == "DE" & CombinedPoliticalValue > 6.5   ~ "Right",   

      Country == "US" & CombinedPoliticalValue <= 4    ~ "Left",    
      Country == "US" & CombinedPoliticalValue <= 7.5  ~ "Center",  
      Country == "US" & CombinedPoliticalValue > 7.5   ~ "Right"  
    )
  )
```

Here we see the distribution of the Political Groups by Country.

In the USA, the "Left" and "Right" political groups have slightly larger percentages than these in Germany. This implies that there may be greater political polarisation in the USA (which we have already seen before), with a higher percentage of people identifying with the extremes of the political spectrum. As we've observed, the political self-assessment in the USA tends to skew more to the right.
```{r}
# bar chart 
ggplot(df_3_tresh_cleaned, aes(x = PoliticalGroup, fill = PoliticalGroup)) +
  geom_bar(aes(y = ..count..), stat = "count") +  
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5) +  # numbers above the bars
  labs(
    title = "Distribution of Political Groups by Country",  
    x = "Political Group",  # x-axis
    y = "Number of People"  # y-axis
  ) +
  facet_wrap(~ Country) +  # Split by country
  theme_minimal() +  
  scale_fill_manual(values = c("Left" = "#66c2a5", "Center" = "#fc8d62", "Right" = "#8da0cb")) +
  scale_y_continuous(limits = c(0, 1000))

# bar chart with percentages

ggplot(df_3_tresh_cleaned, aes(x = PoliticalGroup, fill = PoliticalGroup)) +
  geom_bar(stat = "count", position = "stack") +
  geom_text(
    stat = "count", 
    aes(label = scales::percent(..count.. / sum(..count..))), 
    vjust = -0.5  
  ) +  
  labs(
    title = "Distribution of Political Groups by Country",
    x = "Political Group",  # x-axis
    y = "Number of People"  # y-axis
  ) +
  facet_wrap(~ Country) +  # Split by country 
  theme_minimal() +  
  scale_fill_manual(values = c("Left" = "#66c2a5", "Center" = "#fc8d62", "Right" = "#8da0cb")) +  
   scale_y_continuous(limits = c(0, 1000))  

```

Boxplot of the Political Orientation Distribution by Country.
```{r}
ggplot(df_3_tresh_cleaned, aes(x = Country, y = CombinedPoliticalValue, fill = Country)) +
  geom_boxplot() +
  labs(
    title = "Political Orientation Distribution by Country",
    x = "Country",
    y = "Political Value (0-10)"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("DE" = "#66c2a5", "US" = "#8da0cb"))
```





```{r}
ggplot(df_3_tresh_cleaned_long_us, aes(x = CombinedPoliticalValue, y = Rating, color = Risk_Dimension_f)) +
  geom_smooth(method = "lm", se = TRUE) + 
  facet_wrap(~ Risk_Dimension_f) +
  labs(title = "Einfluss der politischen Orientierung auf Risikowahrnehmung nach Dimension") +
  theme_minimal()

```


Now I am going to convert "PoliticalGroup" to a factor in order to perform a mixed effects model in the next step.
```{r}
df_3_tresh_cleaned_long <- df_3_tresh_cleaned_long %>%
  mutate(
    PoliticalGroup = factor(PoliticalGroup, levels = c("Left", "Center", "Right"))
  )
```

## Testing a Mixed Effects Model with Political Groups

Consideration for the Right Model Choice:

Continuous Political Scale: I think if I treat political orientation as a continuous scale this might be better suited for the mixed-effects model. By using a continuous variable, I can capture the full range of variation in political orientation and analyze the effects more precisely. A continuous scale could also allow me to detect more subtle differences in how political views influence the perception of risks, as it doesn't force a categorization and keeps the data's variability intact.

Political Groups: On the other hand, if I focus on the three political groups (and I believe these groups have significantly different risk perceptions), using a categorical division could make sense. However, I must keep in mind that smaller group sizes in each category might reduce the statistical power of my tests, maybe leading to less reliable estimates. As we see below I think this could be problematic when trying to detect significant differences between groups and risks.
```{r}
model3_usa_group <- lmer(Rating ~ PoliticalGroup * Risk_Dimension_f + 
              PoliticalGroup:Risk_f + 
              gender + age + education + 
              (1 | id) + (1 | Risk_f) + (1 | CombinedPoliticalValue), 
              data = df_3_tresh_cleaned_long_us)

summary(model3_usa_group)
```


# Visualisations for a general overview of the data

The current plot shows the distribution of political orientation in the two countries.

```{r}
ggplot(df_3_tresh_cleaned_long, aes(x = CombinedPoliticalValue, y = ..density.., color = Country)) +
  stat_density(geom = "line", size = 1.2, adjust = 1) +
  labs(title = "Risk Perception by Political Orientation and Country",
       x = "Political Orientation",
       y = "Density",
       color = "Country") +
  scale_color_discrete(labels = c("US" = "USA", "DE" = "Germany")) +  
  theme_minimal() +
  theme(legend.title = element_blank(), 
        legend.position = "bottom", 
        legend.key = element_blank()) 
```

```{r}
ggplot(df_3_tresh_cleaned_long, aes(x = CombinedPoliticalValue, y = ..density.., color = interaction(Country, Risk_Dimension_f))) +
  stat_density(geom = "line", size = 1.2, adjust = 1) +
  labs(title = "Risk Perception by Political Orientation, Country and Risk Dimension",
       x = "Political Orientation",
       y = "Density",
       color = "Country & Risk Dimension") +
  theme_minimal() +
  theme(legend.position = "top") 
```



```{r}
ggplot(df_3_tresh_cleaned_long_us, aes(x = CombinedPoliticalValue, color = Risk_Dimension_f, group = Risk_Dimension_f)) +
  stat_density(geom = "line", aes(y = ..density..), size = 1.2, adjust = 1) + 
  labs(title = "Risk Perception by Political Orientation and Risk Dimension",
       x = "Political Orientation",
       y = "Density") +
  scale_color_manual(values = c("Affect" = "blue", "Probs" = "red", "Sever" = "green")) + # Farben explizit zuweisen
  theme_minimal() +
  theme(legend.title = element_blank(), 
        legend.position = "top") +
  theme(legend.key = element_rect(fill = "white")) 
```

```{r}
ggplot(df_3_tresh_cleaned_long, aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(method = "loess", size = 1.2, se = FALSE, adjust = 1.5) +  # glätten der Linien
  labs(title = "Risk Perception by Political Orientation and Country",
       x = "Political Orientation",
       y = "Risk Perception",
       color = "Country") +
  scale_color_manual(values = c("US" = "#4F81BD", "DE" = "#E57373")) +  # sanfte Farbwahl
  theme_minimal() +
  theme(legend.position = "bottom", 
        legend.title = element_blank(), 
        legend.key = element_blank(),
        strip.text = element_text(size = 12, face = "bold"))  # für saubere Schriftarten


```

```{r}
# Density by Political Orientation and Country
ggplot(df_3_tresh_cleaned_long, aes(x = CombinedPoliticalValue, fill = Country, color = Country)) +
  geom_density(alpha = 0.4, size = 1.2) +
  labs(x = "Political Orientation",
       y = "Density") +
  scale_color_manual(values = c("US" = "#4F81BD", "DE" = "#E57373"),
                     labels = c("US" = "USA", "DE" = "Germany")) +
  scale_fill_manual(values = c("US" = "#4F81BD", "DE" = "#E57373"),
                    labels = c("US" = "USA", "DE" = "Germany")) +
  theme_minimal() +
  theme(legend.position = "bottom", 
        legend.title = element_blank(), 
        strip.text = element_text(size = 12, face = "bold"))

# same plot, only colored lines
ggplot(df_3_tresh_cleaned_long, aes(x = CombinedPoliticalValue, color = Country)) +
  geom_density(alpha = 0.4, size = 1.2) +
  labs(x = "Political Orientation",
       y = "Density") +
  scale_color_manual(values = c("US" = "#4F81BD", "DE" = "#E57373"),
                     labels = c("US" = "USA", "DE" = "Germany")) +
  scale_fill_manual(values = c("US" = "#4F81BD", "DE" = "#E57373"),
                    labels = c("US" = "USA", "DE" = "Germany")) +
  theme_minimal() +
  theme(legend.position = "bottom", 
        legend.title = element_blank(), 
        strip.text = element_text(size = 12, face = "bold"))


# Risk Perception Density by Political Orientation and Country
ggplot(df_3_tresh_cleaned_long, 
       aes(x = Rating, 
           weight = CombinedPoliticalValue, 
           fill = Country, 
           color = Country)) +
  geom_density(alpha = 0.4, size = 1.2) +
  labs(x = "Risk Perception",
       y = "Density") +
  scale_color_manual(values = c("US" = "#4F81BD", "DE" = "#E57373"),
                     labels = c("US" = "USA", "DE" = "Germany")) +
  scale_fill_manual(values = c("US" = "#4F81BD", "DE" = "#E57373"),
                    labels = c("US" = "USA", "DE" = "Germany")) +
  theme_minimal() +
  theme(legend.position = "bottom", 
        legend.title = element_blank(), 
        strip.text = element_text(size = 12, face = "bold"))


# same plot, only with colored lines
ggplot(df_3_tresh_cleaned_long, 
       aes(x = Rating, 
           weight = CombinedPoliticalValue, 
           color = Country)) +
  geom_density(size = 1.2) +
  labs(x = "Risk Perception",
       y = "Density") +
  scale_color_manual(values = c("US" = "#4F81BD", "DE" = "#E57373"),
                     labels = c("US" = "USA", "DE" = "Germany")) +
  theme_minimal() +
  theme(legend.position = "bottom", 
        legend.title = element_blank(), 
        strip.text = element_text(size = 12, face = "bold"))



```

```{r}
str(df_3_tresh_cleaned_long$PoliticalGroup)

```

Risk Perception by Political Orientation for Different Risks
```{r, fig.width=11, fig.height=8}
# Plot erstellen mit Risikodomain, expliziten Namen der Risiken und Ländernamen als Label
ggplot(df_3_tresh_cleaned_long  %>% filter(Risk_Dimension == "Affect"), aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +  # Gruppieren nach Land
  labs(x = "Political Orientation",
       y = "Risk Perception") +
  facet_wrap(~ factor(Risk, 
                     levels = c("Vaccination", "ViralPandemic", "MentHealthProb",  # Health
                                "SexAssault", "GunViol", "Terrorism",  # Crime
                                "ClimateChange", "NaturalDisast", "NuclPowerPlant",  # Nature
                                "IllegImmigrat", "PolitCorrupt", "EconCrisis"),  # Social/Political
                     labels = c("Vaccination Side Effects", 
                                "Viral Pandemic", 
                                "Mental Health Problems",
                                "Sexual Assault",
                                "Gun Violence",
                                "Terrorism",
                                "Climate Change",
                                "Natural Disaster",
                                "Nuclear Power Plant Incident",
                                "Illegal Immigration",
                                "Political Corruption",
                                "Economic Crisis"))) +  # Risikonamen anpassen
  scale_color_manual(values = c("DE" = "#4F81BD", "US" = "#E57373"), 
                     labels = c("DE" = "Germany", "US" = "USA")) +  # Farben und Labels für DE und US
  theme_minimal() +
  theme(legend.position = "bottom", 
        legend.title = element_blank(), 
        strip.text = element_text(size = 12, face = "bold"))



ggplot(df_3_tresh_cleaned_long %>% filter(Country == "US"),
       aes(x = CombinedPoliticalValue, y = Rating, color = Risk_Dimension)) +
  geom_smooth(method = "loess", se = FALSE, size = 1.2, aes(group = Risk_Dimension)) +  # Drei Linien für jede Dimension
  labs(x = "Political Orientation",
       y = "Risk Perception") +
  facet_wrap(~ factor(Risk, 
                     levels = c("Vaccination", "ViralPandemic", "MentHealthProb",  # Health
                                "SexAssault", "GunViol", "Terrorism",  # Crime
                                "ClimateChange", "NaturalDisast", "NuclPowerPlant",  # Nature
                                "IllegImmigrat", "PolitCorrupt", "EconCrisis"),  # Social/Political
                     labels = c("Vaccination Side Effects", 
                                "Viral Pandemic", 
                                "Mental Health Problems",
                                "Sexual Assault",
                                "Gun Violence",
                                "Terrorism",
                                "Climate Change",
                                "Natural Disaster",
                                "Nuclear Power Plant Incident",
                                "Illegal Immigration",
                                "Political Corruption",
                                "Economic Crisis"))) +  # Risikonamen anpassen
  scale_color_manual(values = c("Affect" = "#4CAF50", 
                                "Probs" = "#8BC34A", 
                                "Sever" = "#388E3C"),
                     labels = c("Affect" = "Affect", 
                                "Probs" = "Probability", 
                                "Sever" = "Consequence")) +  # Farben für die Dimensionen
  theme_minimal() +
  theme(legend.position = "bottom", 
        legend.title = element_blank(), 
        legend.text = element_text(size = 10),
        strip.text = element_text(size = 12, face = "bold"),
        axis.title = element_text(size = 14, face = "bold"),
        axis.text = element_text(size = 12))




```

# USA Affective Dimension

```{r, fig.width=11, fig.height=8}



 # Plot nur für USA, gleiche Ästhetik wie für Deutschland
ggplot(df_3_tresh_cleaned_long  %>% 
         filter(Risk_Dimension == "Affect", Country == "US"), 
       aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +  # Gruppieren nach Land
  labs(x = "Political Orientation",
       y = "Risk Perception") +
  facet_wrap(~ factor(Risk, 
                     levels = c("Vaccination", "ViralPandemic", "MentHealthProb",  # Health
                                "SexAssault", "GunViol", "Terrorism",  # Crime
                                "ClimateChange", "NaturalDisast", "NuclPowerPlant",  # Nature
                                "IllegImmigrat", "PolitCorrupt", "EconCrisis"),  # Social/Political
                     labels = c("Vaccination Side Effects", 
                                "Viral Pandemic", 
                                "Mental Health Problems",
                                "Sexual Assault",
                                "Gun Violence",
                                "Terrorism",
                                "Climate Change",
                                "Natural Disaster",
                                "Nuclear Power Plant Incident",
                                "Illegal Immigration",
                                "Political Corruption",
                                "Economic Crisis"))) +  # Risikonamen anpassen
  scale_color_manual(values = c("US" = "#E57373")) +  # Nur USA-Farbe, keine Labels
  theme_minimal(base_size = 14) +   # erhöht alle Grundschriften
  theme(
    legend.position = "none",
    legend.title = element_blank(),
    strip.text = element_text(size = 13, face = "bold"),
    axis.text = element_text(size = 13),
    axis.title = element_text(size = 14)
  )

# Plot speichern
ggsave("USA_Affect_Plot.png", 
       plot = last_plot(), 
       width = 11, height = 8, dpi = 300, 
       bg = "white")  # Hintergrund auf weiß setzen




#setwd("C:\\Users\\vanes\\OneDrive\\Desktop\\Master Psychologie\\4. Semester\\Masterarbeit\\Datafiles\\Plots") 

```

# Germany Affective Dimension
```{r}

# Plot nur für Deutschland, gleiche Ästhetik, ohne Legende
ggplot(df_3_tresh_cleaned_long  %>% 
         filter(Risk_Dimension == "Affect", Country == "DE"), 
       aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +  # Gruppieren nach Land
  labs(x = "Political Orientation",
       y = "Risk Perception") +
  facet_wrap(~ factor(Risk, 
                     levels = c("Vaccination", "ViralPandemic", "MentHealthProb",  # Health
                                "SexAssault", "GunViol", "Terrorism",  # Crime
                                "ClimateChange", "NaturalDisast", "NuclPowerPlant",  # Nature
                                "IllegImmigrat", "PolitCorrupt", "EconCrisis"),  # Social/Political
                     labels = c("Vaccination Side Effects", 
                                "Viral Pandemic", 
                                "Mental Health Problems",
                                "Sexual Assault",
                                "Gun Violence",
                                "Terrorism",
                                "Climate Change",
                                "Natural Disaster",
                                "Nuclear Power Plant Incident",
                                "Illegal Immigration",
                                "Political Corruption",
                                "Economic Crisis"))) +  # Risikonamen anpassen
  scale_color_manual(values = c("DE" = "#4F81BD")) +  # Nur Deutschland-Farbe, keine Labels
   theme_minimal(base_size = 14) +   # erhöht alle Grundschriften
theme(
  legend.position = "none",
  legend.title = element_blank(),
  strip.text = element_text(size = 13, face = "bold"),
  axis.text = element_text(size = 13),
  axis.title = element_text(size = 14)
)


ggsave("Germany_Affect_Plot.png", 
       plot = last_plot(), 
       width = 11, height = 8, dpi = 300, 
       bg = "white")  # Hintergrund auf weiß setzen

```


```{r}
# Plot für Risk Domains mit Y-Achse von 4 bis 7
ggplot(df_3_tresh_cleaned_long %>% filter(Risk_Dimension == "Affect"), 
       aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +
  facet_wrap(~ Risk_Domain, scales = "free_y") +  # Facet nach Risk_Domain
  labs(x = "Political Orientation",
       y = "Risk Perception") +
  scale_color_manual(values = c("DE" = "#4F81BD", "US" = "#E57373")) +
  scale_y_continuous(breaks = c(4, 5, 6, 7), limits = c(4, 7)) +  # Y-Achse angepasst
  scale_x_continuous(breaks = 1:10) +
  theme_minimal(base_size = 14) +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    strip.text = element_text(size = 14, face = "bold"),
    axis.text = element_text(size = 13),
    axis.title = element_text(size = 14)
  )

# Plot speichern
ggsave("Affect_RiskDomains_Plot.png", plot = last_plot(), width = 11, height = 8, dpi = 300, bg = "white")


```




```{r}
df_summary <- df_3_tresh_cleaned_long %>%
  group_by(Risk, PoliticalGroup) %>%
  summarise(avg_risk = mean(Rating, na.rm = TRUE))

ggplot(df_summary, aes(x = Risk, y = avg_risk, fill = PoliticalGroup)) +
  geom_bar(stat = "identity", position = "dodge", width = 0.7) +  # Balkendiagramm für Durchschnitt
  labs(title = "Average Risk Perception by Political Orientation and Risk",
       x = "Risk",
       y = "Average Risk Perception") +
  scale_fill_manual(values = c("Left" = "#4F81BD", "Center" = "#E57373", "Right" = "#A52714")) +
  theme_minimal() +
  theme(legend.position = "bottom", 
        legend.title = element_blank(),
        strip.text = element_text(size = 12, face = "bold"))

```

```{r}
ggplot(df_3_tresh_cleaned_long %>% filter(Risk_Dimension == "Affect"),
       aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +
  labs(title = "Risk Perception (Affect Dimension) by Political Orientation and Country",
       x = "Political Orientation",
       y = "Risk Perception") +
  scale_color_manual(values = c("DE" = "#4F81BD", "US" = "#E57373"),
                     labels = c("DE" = "Germany", "US" = "USA")) +
  facet_wrap(~ Risk, scales = "free_y") +
  theme_minimal() +
  theme(legend.position = "bottom",
        legend.title = element_blank(),
        strip.text = element_text(size = 12, face = "bold"))

```
```{r}
ggplot(df_3_tresh_cleaned_long %>% filter(Risk_Dimension == "Probs"),
       aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +
  labs(title = "Risk Perception (Probability Dimension) by Political Orientation and Country",
       x = "Political Orientation",
       y = "Risk Perception") +
  scale_color_manual(values = c("DE" = "#4F81BD", "US" = "#E57373"),
                     labels = c("DE" = "Germany", "US" = "USA")) +
  facet_wrap(~ Risk, scales = "free_y") +
  theme_minimal() +
  theme(legend.position = "bottom",
        legend.title = element_blank(),
        strip.text = element_text(size = 12, face = "bold"))

```

```{r}
ggplot(df_3_tresh_cleaned_long %>% filter(Risk_Dimension == "Sever"),
       aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +
  labs(title = "Risk Perception (Consequence Dimension) by Political Orientation and Country",
       x = "Political Orientation",
       y = "Risk Perception") +
  scale_color_manual(values = c("DE" = "#4F81BD", "US" = "#E57373"),
                     labels = c("DE" = "Germany", "US" = "USA")) +
  facet_wrap(~ Risk, scales = "free_y") +
  theme_minimal() +
  theme(legend.position = "bottom",
        legend.title = element_blank(),
        strip.text = element_text(size = 12, face = "bold"))

```

# Risk Perception Across Political Orientation by Domains
```{r}
#library(ggplot2)
#library(dplyr)
#library(grid)  # für unit()

# Deutschland-Plot mit größerer Legende und breiteren Farbkästchen
germany_plot <- ggplot(df_3_tresh_cleaned_long %>% filter(Country == "DE"),
                       aes(x = CombinedPoliticalValue, y = Rating, color = Risk_Dimension)) +
  geom_smooth(method = "loess", se = FALSE, size = 1.2, aes(group = Risk_Dimension)) +
  labs(title = "Risk Perception Across Political Orientation by Risk Dimension",
       x = "Political Orientation",
       y = "Risk Perception",
       color = "Risk Dimension") +
  scale_color_manual(
    values = c("Affect" = "#4CAF50", "Probs" = "#8BC34A", "Sever" = "#388E3C"),
    labels = c("Affect" = "Affect", "Probs" = "Probability", "Sever" = "Consequence")
  ) +
  theme_minimal(base_size = 16) +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 16, face = "bold"),  # Legendentitel größer
    legend.text = element_text(size = 14),                  # Legenden-Einträge größer
    legend.key.width = unit(2, "cm"),                      # Breitere Farbkästchen
    strip.text = element_text(size = 16, face = "bold"),
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 16),
    plot.title = element_text(size = 18, face = "bold")
  )

# Speichern
ggsave("Germany_RiskDimension_Plot_LegendBig.png", plot = germany_plot, width = 11, height = 8, dpi = 300, bg = "white")



## USA-Plot mit größerer Legende und breiteren Farbkästchen
usa_plot <- ggplot(df_3_tresh_cleaned_long %>% filter(Country == "US"),
                   aes(x = CombinedPoliticalValue, y = Rating, color = Risk_Dimension)) +
  geom_smooth(method = "loess", se = FALSE, size = 1.2, aes(group = Risk_Dimension)) +
  labs(title = "Risk Perception Across Political Orientation by Risk Dimension",
       x = "Political Orientation",
       y = "Risk Perception",
       color = "Risk Dimension") +
  scale_color_manual(
    values = c("Affect" = "#4CAF50", "Probs" = "#8BC34A", "Sever" = "#388E3C"),
    labels = c("Affect" = "Affect", "Probs" = "Probability", "Sever" = "Consequence")
  ) +
  theme_minimal(base_size = 16) +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 16, face = "bold"),  # Legendentitel größer
    legend.text = element_text(size = 14),                  # Legenden-Einträge größer
    legend.key.width = unit(2, "cm"),                      # Breitere Farbkästchen
    strip.text = element_text(size = 16, face = "bold"),
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 16),
    plot.title = element_text(size = 18, face = "bold")
  )

# Plot speichern
ggsave("USA_RiskDimension_Plot_LegendBig.png", plot = usa_plot, width = 11, height = 8, dpi = 300, bg = "white")



#library(ggthemes)
#install.packages("ggthemes")



```

```{r}
# Berechnung des Mittelwerts der Risikowahrnehmung nach politischer Orientierung und Risikodimension
df_mean <- df_3_tresh_cleaned_long %>%
  filter(Country %in% c("DE", "US")) %>%
  group_by(Country, CombinedPoliticalValue, Risk_Dimension) %>%
  summarise(AvgRating = mean(Rating), .groups = "drop")

# Lollipop-Chart für die Mittelwerte der Risikowahrnehmung nach politischer Orientierung und Risikodimension
ggplot(df_mean, aes(x = CombinedPoliticalValue, y = AvgRating, color = Risk_Dimension)) +
  geom_segment(aes(xend = CombinedPoliticalValue, yend = 0), size = 1.2) +  # Linien von 0 bis zum Mittelwert
  geom_point(size = 4) +  # Punkte am Ende der Linien
  labs(title = "Lollipop Chart: Average Risk Perception by Political Orientation and Risk Dimension",
       x = "Political Orientation (Continuous)",
       y = "Average Risk Perception",
       color = "Risk Dimension") +
  scale_color_manual(
    values = c("Affect" = "#4CAF50", "Probs" = "#8BC34A", "Sever" = "#388E3C"),
    labels = c("Affect" = "Affect", "Probs" = "Probability", "Sever" = "Consequence")
  ) +
  facet_wrap(~ Country) +  # Facetten für jedes Land
  theme_minimal() +
  theme(legend.position = "bottom",
        legend.title = element_text(size = 10),
        legend.text = element_text(size = 10),
        strip.text = element_text(size = 12, face = "bold"))



```

# Plot Domains
```{r}
ggplot(df_3_tresh_cleaned_long %>% filter(Country %in% c("DE", "US")),
       aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +
  labs(title = "Risk Perception by Political Orientation and Country",
       x = "Political Orientation",
       y = "Risk Perception") +
  scale_color_manual(values = c("DE" = "#4F81BD", "US" = "#E57373"),
                     labels = c("DE" = "Germany", "US" = "USA")) +
  facet_wrap(~ Risk_Domain, scales = "free_y") +  # Facetten für jede Risk Domain (Nature, Crime, Health, Social/Political)
  theme_minimal() +
  theme(legend.position = "bottom",
        legend.title = element_blank(),
        strip.text = element_text(size = 12, face = "bold"))


```


# Plot Domains Affective Dimension
```{r}
ggplot(df_3_tresh_cleaned_long %>% filter(Country %in% c("DE", "US", Risk_Dimension == "Affect")),
       aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +
  labs(x = "Political Orientation",
       y = "Risk Perception") +
  scale_color_manual(values = c("DE" = "#4F81BD", "US" = "#E57373"),
                     labels = c("DE" = "Germany", "US" = "USA")) +
  facet_wrap(~ Risk_Domain, scales = "free_y") +  # Facetten für jede Risk Domain (Nature, Crime, Health, Social/Political)
  theme_minimal() +
  theme(legend.position = "bottom",
        legend.title = element_blank(),
        strip.text = element_text(size = 12, face = "bold"))


```

# Domains Germany and USA

```{r}
germany_domain_plot <- ggplot(df_3_tresh_cleaned_long %>% 
                                filter(Country == "DE", Risk_Dimension == "Affect"),
                              aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +
  labs(x = "Political Orientation",
       y = "Risk Perception") +  # Kein Titel
  scale_color_manual(values = c("DE" = "#4F81BD")) +
  facet_wrap(~ Risk_Domain, scales = "fixed") +
  theme_minimal(base_size = 16) +
  theme(
    legend.position = "none",
    legend.title = element_blank(),
    legend.text = element_text(size = 14),
    legend.key.width = unit(2, "cm"),
    strip.text = element_text(size = 16, face = "bold"),
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 16)
  )

# Speichern
ggsave("Germany_RiskDomains_Affect.png", plot = germany_domain_plot, width = 11, height = 8, dpi = 300, bg = "white")



usa_domain_plot <- ggplot(df_3_tresh_cleaned_long %>% 
                            filter(Country == "US", Risk_Dimension == "Affect"),
                          aes(x = CombinedPoliticalValue, y = Rating, color = Country)) +
  geom_smooth(aes(group = Country), method = "loess", size = 1.2, se = FALSE) +
  labs(x = "Political Orientation",
       y = "Risk Perception") +
  scale_color_manual(values = c("US" = "#E57373")) +
  facet_wrap(~ Risk_Domain, scales = "fixed") +
  theme_minimal(base_size = 16) +
  theme(
    legend.position = "none",
    legend.title = element_blank(),
    legend.text = element_text(size = 14),
    legend.key.width = unit(2, "cm"),
    strip.text = element_text(size = 16, face = "bold"),
    axis.text = element_text(size = 14),
    axis.title = element_text(size = 16)
  )

# Speichern
ggsave("USA_RiskDomains_Affect.png", plot = usa_domain_plot, width = 11, height = 8, dpi = 300, bg = "white")



```

```{r}
ggplot(df_3_tresh_cleaned_long, aes(x = CombinedPoliticalValue, y = Rating, color = gender)) +
  geom_smooth(method = "loess", se = FALSE, aes(group = gender)) +
  labs(title = "Moderation of Political Orientation on Risk Perception by Gender",
       x = "Political Orientation",
       y = "Risk Perception",
       color = "Gender") +
  theme_minimal() +
  theme(legend.position = "bottom")


```

```{r}
lm(Rating ~ CombinedPoliticalValue * gender, data = df_3_tresh_cleaned_long)


```

```{r}


```












# Mean Risk Perception Visualization Idea
```{r, fig.width=10, fig.height=8}

df_aggregated_us <- df_3_tresh_cleaned_long %>%
  filter(Country == "US") %>%
  mutate(
    PolitCategory = case_when(
      LeftRightPolitValue <= 3 ~ "Very Left",
      LeftRightPolitValue >= 8 ~ "Very Right",
      TRUE ~ "Middle"
    ),
    PolitCategory = factor(PolitCategory, levels = c("Very Left", "Middle", "Very Right")),  # Set the factor levels correctly
    Risk_f = recode(Risk_f, 
                    "Vaccination" = "Vaccination", 
                    "ViralPandemic" = "Viral Pandemic",
                    "MentHealthProb" = "Mental Health Problems",  # Correct here
                    "SexAssault" = "Sexual Assault",
                    "GunViol" = "Gun Violence",
                    "Terrorism" = "Terrorism",
                    "ClimateChange" = "Climate Change",
                    "NaturalDisast" = "Natural Disaster",
                    "NuclPowerPlant" = "Nuclear Power Plant",
                    "IllegImmigrat" = "Illegal Immigration",
                    "PolitCorrupt" = "Political Corruption",
                    "EconCrisis" = "Economic Crisis"),
    RiskDomain = case_when(
      Risk_f %in% c("Vaccination", "Viral Pandemic", "Mental Health Problems") ~ "Health",
      Risk_f %in% c("Sexual Assault", "Gun Violence", "Terrorism") ~ "Crime",
      Risk_f %in% c("Climate Change", "Natural Disaster", "Nuclear Power Plant") ~ "Nature",
      Risk_f %in% c("Illegal Immigration", "Political Corruption", "Economic Crisis") ~ "Social/Political",
      TRUE ~ "Other"
    )
  )

# Make sure there are no NA values
df_aggregated_us <- df_aggregated_us %>% 
  filter(!is.na(Rating))

# Calculate the mean of the risk perception
df_agg_mean_us <- df_aggregated_us %>%
  group_by(PolitCategory, RiskDomain, Risk_f) %>%
  summarise(MeanRating = mean(Rating, na.rm = TRUE), .groups = 'drop')

# Manually set the order for the y-axis based on the domain and risk rank
df_agg_mean_us$Risk_f <- factor(df_agg_mean_us$Risk_f, levels = c(
  "Vaccination", "Mental Health Problems", "Viral Pandemic", # Health
  "Sexual Assault", "Gun Violence", "Terrorism",              # Crime
  "Climate Change", "Natural Disaster", "Nuclear Power Plant",# Nature
  "Illegal Immigration", "Political Corruption", "Economic Crisis" # Social/Political
))

# Scatter plot for mean risk perception
us_x <- df_agg_mean_us %>%
  ggplot(aes(x = MeanRating, y = Risk_f, color = PolitCategory)) + 
  geom_point(size = 4, alpha = 0.7) +  # Point size and transparency
  scale_color_manual(values = c("Very Left" = "#4f81bd", 
                                "Middle" = "#F2CB00", 
                                "Very Right" = "#D84A2E")) +  # Custom color scale for political orientation
  labs(title = "Mean Risk Perception by Political Orientation (USA)",
       x = "Mean Risk Perception",
       y = "Risk",
       color = "Political Orientation") +
  scale_x_continuous(limits = c(0, 10)) +  # Set the horizontal axis from 0 to 10
  theme_minimal() +  # Clean and simple appearance
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )


# Display the plot US
print(us_x)

```


```{r, fig.width=10, fig.height=8}

# Germany
df_aggregated_de <- df_3_tresh_cleaned_long %>%
  filter(Country == "DE") %>%
  mutate(
    PolitCategory = case_when(
      LeftRightPolitValue <= 3 ~ "Very Left",
      LeftRightPolitValue >= 8 ~ "Very Right",
      TRUE ~ "Middle"
    ),
    PolitCategory = factor(PolitCategory, levels = c("Very Left", "Middle", "Very Right")),  # Set the factor levels correctly
    Risk_f = recode(Risk_f, 
                    "Vaccination" = "Vaccination", 
                    "ViralPandemic" = "Viral Pandemic",
                    "MentHealthProb" = "Mental Health Problems",  # Correct here
                    "SexAssault" = "Sexual Assault",
                    "GunViol" = "Gun Violence",
                    "Terrorism" = "Terrorism",
                    "ClimateChange" = "Climate Change",
                    "NaturalDisast" = "Natural Disaster",
                    "NuclPowerPlant" = "Nuclear Power Plant",
                    "IllegImmigrat" = "Illegal Immigration",
                    "PolitCorrupt" = "Political Corruption",
                    "EconCrisis" = "Economic Crisis"),
    RiskDomain = case_when(
      Risk_f %in% c("Vaccination", "Viral Pandemic", "Mental Health Problems") ~ "Health",
      Risk_f %in% c("Sexual Assault", "Gun Violence", "Terrorism") ~ "Crime",
      Risk_f %in% c("Climate Change", "Natural Disaster", "Nuclear Power Plant") ~ "Nature",
      Risk_f %in% c("Illegal Immigration", "Political Corruption", "Economic Crisis") ~ "Social/Political",
      TRUE ~ "Other"
    )
  )

# Make sure there are no NA values
df_aggregated_de <- df_aggregated_de %>% 
  filter(!is.na(Rating))

# Calculate the mean of the risk perception
df_agg_mean_de <- df_aggregated_de %>%
  group_by(PolitCategory, RiskDomain, Risk_f) %>%
  summarise(MeanRating = mean(Rating, na.rm = TRUE), .groups = 'drop')

# Manually set the order for the y-axis based on the domain and risk rank
df_agg_mean_de$Risk_f <- factor(df_agg_mean_de$Risk_f, levels = c(
  "Vaccination", "Mental Health Problems", "Viral Pandemic", # Health
  "Sexual Assault", "Gun Violence", "Terrorism",              # Crime
  "Climate Change", "Natural Disaster", "Nuclear Power Plant",# Nature
  "Illegal Immigration", "Political Corruption", "Economic Crisis" # Social/Political
))

# Scatter plot for mean risk perception
de_x <- df_agg_mean_de %>%
  ggplot(aes(x = MeanRating, y = Risk_f, color = PolitCategory)) + 
  geom_point(size = 4, alpha = 0.7) +  # Point size and transparency
  scale_color_manual(values = c("Very Left" = "#4f81bd", 
                                "Middle" = "#F2CB00", 
                                "Very Right" = "#D84A2E")) +  # Custom color scale for political orientation
  labs(title = "Mean Risk Perception by Political Orientation (Germany)",
       x = "Mean Risk Perception",
       y = "Risk",
       color = "Political Orientation") +
  scale_x_continuous(limits = c(0, 10)) +  # Set the horizontal axis from 0 to 10
  theme_minimal() +  # Clean and simple appearance
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10)
  )


# Display the plot Germany
print(de_x)

```
# Mean Risk Perception USA and Germany combined

```{r, fig.width=14, fig.height=10}

print(us_x + de_x)

```

```{r, fig.width=15, fig.height=8}

# Füge eine Country-Spalte hinzu (falls nicht schon vorhanden)
df_agg_mean_de$Country <- "Germany"
df_agg_mean_us$Country <- "US"

# Kombiniere die beiden Datensätze
df_agg_combined <- bind_rows(df_agg_mean_de, df_agg_mean_us)


# Spaghetti Plot mit ggplot2
ggplot(df_agg_combined, aes(x = Risk_f, y = MeanRating, color = Country, group = Country)) +
  geom_line(aes(linetype = Country), size = 1) +  # Linien für Länder
  geom_point(size = 3) +                          # Punkte für Mittelwerte
  facet_wrap(~ PolitCategory) +                   # Je politischer Kategorie ein Plot
  scale_color_manual(values = c("US" = "#1f77b4", "Germany" = "#ff7f0e")) +  # Eigene Farben
  scale_y_continuous(limits = c(0, 10)) +         # Y-Achse fixieren von 0 bis 10
  labs(
    title = "Risk Perception by Country and Political Orientation",
    subtitle = "Comparison of mean risk perception across US and Germany",
    x = "Risk",
    y = "Mean Risk Perception",
    color = "Country",
    linetype = "Country"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    strip.background = element_rect(fill = "lightgrey", color = "black", size = 1.5),  # Hintergrund für Facetten
    strip.text = element_text(size = 13, face = "bold", color = "black")  # Stil der Facettenbeschriftung
  )


```

```{r, fig.width=16, fig.height=6}

ggplot(
  df_agg_combined,
  aes(
    x = Risk_f,
    y = MeanRating,
    color = PolitCategory,             # Farbe für politische Orientierung
    linetype = Country,                # Linienart für Land
    group = interaction(Country, PolitCategory)  # Gruppierung für Linien
  )
) +
  geom_line(size = 1.2) +
  geom_point(size = 3) +

  scale_color_brewer(palette = "Dark2") +   # Farben für Politische Orientierung
  scale_linetype_manual(values = c("Germany" = "solid", "US" = "dashed")) +

  scale_y_continuous(limits = c(0, 10)) +

  labs(
    title = "Risk Perception by Country and Political Orientation",
    subtitle = "Farben = politische Orientierung | Linienart = Land (Germany = solid, US = dashed)",
    x = "Risk Domain",
    y = "Mean Risk Perception",
    color = "Political Orientation",
    linetype = "Country"
  ) +

  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12),
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    legend.position = "right"
  )

```

```{r, fig.width=18, fig.height=9}

x_domain_de <- ggplot(df_agg_combined %>% filter(Country == "Germany"), 
       aes(x = Risk_f, y = MeanRating, color = PolitCategory, group = PolitCategory)) +
  stat_summary(fun = "mean", geom = "line", size = 1.2) +  # Mittelwert der Risikowahrnehmung für jedes Risiko
  stat_summary(fun = "mean", geom = "point", size = 3) +   # Punkte für Mittelwerte
  scale_color_manual(values = c("Very Left" = "#d62728",  # Rot für "Very Left"
                                "Middle" = "#2ca02c",  # Dunkelgrün für "Middle"
                                "Very Right" = "#1f77b4")) +  # Blau für "Very Right"
  labs(
    title = "Einfluss der politischen Orientierung auf die Risikowahrnehmung",
    subtitle = "Für vier Risikodimensionen in Deutschland",
    x = "Risiko",
    y = "Durchschnittliche Risikowahrnehmung",
    color = "Politische Orientierung"
  ) +
   scale_y_continuous(limits = c(2, 8)) +  # Fixiere Y-Achse von 0 bis 10
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    strip.background = element_rect(fill = "lightgrey", color = "black", size = 1.5),
    strip.text = element_text(size = 13, face = "bold", color = "black"),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10),
     axis.text.x = element_text(angle = 45, hjust = 1)  # Drehung der X-Achse um 45 Grad
  ) +
  facet_wrap(~ RiskDomain, scales = "free_x", ncol = 4)  # Faceting nach Risikodomain, freie x-Achse für die 3 Risiken

print(x_domain_de)
```


```{r, fig.width=18, fig.height=9}

x_domain_us <- ggplot(df_agg_combined %>% filter(Country == "US"), 
       aes(x = Risk_f, y = MeanRating, color = PolitCategory, group = PolitCategory)) +
  stat_summary(fun = "mean", geom = "line", size = 1.2) +  # Mittelwert der Risikowahrnehmung für jedes Risiko
  stat_summary(fun = "mean", geom = "point", size = 3) +   # Punkte für Mittelwerte
  scale_color_manual(values = c("Very Left" = "#d62728",  # Rot für "Very Left"
                                "Middle" = "#2ca02c",  # Dunkelgrün für "Middle"
                                "Very Right" = "#1f77b4")) +  # Blau für "Very Right"
  labs(
    title = "Einfluss der politischen Orientierung auf die Risikowahrnehmung",
    subtitle = "Für vier Risikodimensionen in den USA",
    x = "Risiko",
    y = "Durchschnittliche Risikowahrnehmung",
    color = "Politische Orientierung"
  ) +
  scale_y_continuous(limits = c(2, 8)) +  # Fixiere Y-Achse von 0 bis 10
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 12),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    strip.background = element_rect(fill = "lightgrey", color = "black", size = 1.5),
    strip.text = element_text(size = 13, face = "bold", color = "black"),
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 10),
    axis.text.x = element_text(angle = 45, hjust = 1)  # Drehung der X-Achse um 45 Grad
  ) +
  facet_wrap(~ RiskDomain, scales = "free_x", ncol = 4)  # Faceting nach Risikodomain, freie x-Achse für die 3 Risiken

print(x_domain_us)

```


```{r, fig.width=25, fig.height=10}
# Display both plots
print(x_domain_de + x_domain_us)

```



```{r, fig.width=16, fig.height=6}

# Domain Farben für die X-Achsen-Beschriftung
domain_colors <- c(
  "Health" = "#1f77b4",           # Blau
  "Crime" = "#ff7f0e",            # Orange
  "Nature" = "#2ca02c",           # Grün
  "Social/Political" = "#d62728"  # Rot
)

# Vector mit Farben je Risiko (nach Domain)
risk_colors <- df_agg_combined %>%
  distinct(Risk_f, RiskDomain) %>%
  arrange(Risk_f) %>%
  mutate(color = domain_colors[RiskDomain]) %>%
  pull(color)

# Set Faktor-Level explizit, falls nötig
df_agg_combined$Risk_f <- factor(df_agg_combined$Risk_f, levels = c(
  "Vaccination", "Mental Health Problems", "Viral Pandemic",
  "Sexual Assault", "Gun Violence", "Terrorism",
  "Climate Change", "Natural Disaster", "Nuclear Power Plant",
  "Illegal Immigration", "Political Corruption", "Economic Crisis"
))

# Modernere Country-Farben (kannst du ändern)
country_colors <- c("US" = "#377eb8", "Germany" = "#e41a1c")

# SPAGHETTI-PLOT
spaghetti_plot <- ggplot(df_agg_combined, aes(x = Risk_f, y = MeanRating, color = Country, group = Country)) +
  
  # Linien und Punkte
  geom_line(aes(linetype = Country), size = 1.2, alpha = 0.9) +
  geom_point(size = 4, shape = 21, fill = "white", stroke = 1.2) +
  
  # Facet je Politische Kategorie
  facet_wrap(~ PolitCategory, nrow = 1) +
  
  # Achsen & Skalen
  scale_color_manual(values = country_colors) +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0, 10, 2)) +
  
  # Labels & Titel
  labs(
    title = "Risk Perception by Country and Political Orientation",
    subtitle = "Comparison of mean risk perception across US and Germany",
    x = "Risk",
    y = "Mean Risk Perception (0-10)",
    color = "Country",
    linetype = "Country"
  ) +
  
  # Theme verbessern
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, size = 14, color = "gray30"),
    axis.text.x = element_text(angle = 45, hjust = 1, color = risk_colors, size = 11, face = "bold"),
    axis.title = element_text(size = 13),
    axis.text.y = element_text(size = 11),
    strip.background = element_rect(fill = "gray90", color = NA),
    strip.text = element_text(size = 13, face = "bold"),
    panel.grid.major.y = element_line(color = "gray80", size = 0.5),
    panel.grid.minor.y = element_blank(),
    legend.position = "bottom",
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 11)
  )

# Plot anzeigen
print(spaghetti_plot)


```

# Mean Risk Perception US and DE combined

```{r, fig.width=15, fig.height=8}
# Display the plot US
print(us_x + de_x)

```


```{r, fig.width=16, fig.height=8}


```


```{r}



```
# Mixed Effects Model (false)
```{r, fig.width=15, fig.height=6}



```


## Mixed Effects Model 

```{r}
# predicted_rating = fitted(model)

```

```{r}


# 2. Fixe Effekte rausziehen
#fixef(model)

# 3. Random Effects anschauen
#ranef(model)

# 4. Modellgüte (R2)
#library(MuMIn)
#r.squaredGLMM(model)

# 5. Vorhersagen
#fitted_values <- fitted(model)

# 6. Residuen überprüfen
#plot(fitted(model), residuals(model))

```

```{r}
#  Zuerst filtern?

df_3_tresh_cleaned_long_us <- df_3_tresh_cleaned_long %>% filter(Country_f == "US")

 df_3_tresh_cleaned_long_de <- df_3_tresh_cleaned_long %>% filter(Country_f == "DE")

```

```{r}


model <- lmer(Rating ~ Risk_f * Risk_Dimension_f + CombinedPoliticalValue: Risk_f  + gender + age + education + (1| id), data = df_3_tresh_cleaned_long_us)

summary(model)

coef_model <- coefficients(model)
fix_eff <- fixef(model)

# predict 
fitted_values <- fitted(model)
fitted_values_risk <- fitted_values[49:60]

coeff_names <- c("Vaccination", 
                "ViralPandemic",
                "MentHealthProb",
                "SexAssault",
                "GunViol",
                "Terrorism",
                "ClimateChange",
                "NaturalDisast",
                "NuclPowerPlant",
                "IllegImmigrat",
                "PolitCorrupt",
                "EconCrisis")

dataframe <- data.frame(coeff = fitted_values_risk, names = coeff_names)




df_3_tresh_cleaned_long_us$predicted <- predict(model, newdata = df_3_tresh_cleaned_long_us, allow.new.levels = TRUE)

ggplot(df_3_tresh_cleaned_long_us, aes(x = Rating, y = predicted)) +
  geom_point(alpha = 0.2) +              # scatter plot points
  geom_abline(slope = 1, intercept = 0,  # reference line (perfect prediction)
              color = "red", linetype = "dashed") +
  labs(x = "True Ratings", y = "Predicted Ratings",
       title = "Predicted vs True Ratings") +
  theme_minimal()+
  facet_wrap(~Risk_f)




# 6. Residuen überprüfen
plot(fitted(model), residuals(model))

# model <- lmer(Rating ~ Risk_Domain * Risk_f * Risk_Dimension_f +
#                (1 | id) +
 #               (1 | Risk_f),
  #            data = df_3_tresh_cleaned_long,
   #           subset = Country_f == "US")



```
Neue Spalte oder Datafame mit predicted ratings erstellen
```{r}
# predicted_rating = fitted(model)

```


# Die vorhergesagten Regressionskoeffizienten in die Scatterplots einfügen (Affect Dimension)

```{r, fig.width=12, fig.height=8}

# df_long %>%
  filter(Risk_Dimension_f == "Affect") %>%  # choose Dimension
  mutate(Risk_f = fct_relevel(Risk_f, 
                              # Health
                              "Vaccination", "ViralPandemic", "MentHealthProb", 
                              # Crime
                              "SexAssault", "GunViol", "Terrorism", 
                              # Nature
                              "ClimateChange", "NaturalDisast", "NuclPowerPlant", 
                              # Social/Political
                              "IllegImmigrat", "PolitCorrupt", "EconCrisis")) %>%

  ggplot(aes(x = CombinedPoliticalValue_f, y = Rating)) +  # Use CombinedPoliticalValue_f
  
  # points
  geom_jitter(alpha = .2) +
  
  # Regressionslinie für CombinedPoliticalValue_f (rot)
  geom_smooth(aes(x = CombinedPoliticalValue_f, color = "CombinedPoliticalValue_f", linetype = "CombinedPoliticalValue_f"), 
              method = "lm", se = FALSE) +  # Regressionline für CombinedPoliticalValue_f
  
  # Facetten nach Risiko, sortiert nach Domain
  facet_wrap(
    ~ Risk_f, 
    scales = "fixed",    # gleiche Achsen für besseren Vergleich
    ncol = 3,            # 3 Spalten
    nrow = 4,            # 4 Zeilen
    labeller = labeller(
      Risk_f = c(
        "Vaccination" = "Vaccination",
        "ViralPandemic" = "Viral Pandemic",
        "MentHealthProb" = "Mental Health Problems",
        "SexAssault" = "Sexual Assault",
        "GunViol" = "Gun Violence",
        "Terrorism" = "Terrorism",
        "ClimateChange" = "Climate Change",
        "NaturalDisast" = "Natural Disaster",
        "NuclPowerPlant" = "Nuclear Power Plant Incident",
        "IllegImmigrat" = "Illegal Immigration",
        "PolitCorrupt" = "Political Corruption",
        "EconCrisis" = "Economic Crisis"
      )
    )
  ) +
  
  labs(
    title = "The Impact of Political Orientation on Risk Perception (Affect)",
    x = "Political Orientation",
    y = "Risk Perception (Affect)",
    color = "Political Orientation",
    linetype = "Political Orientation"
  ) +

  # Farben für CombinedPoliticalValue_f
  scale_color_manual(values = c("CombinedPoliticalValue_f" = "red")) +  # Nur eine Farbe für CombinedPoliticalValue_f
  scale_linetype_manual(values = c("CombinedPoliticalValue_f" = "solid")) +  # Linie für CombinedPoliticalValue_f

  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.title = element_text(size = 12),
    axis.text = element_text(size = 10),
    strip.text = element_text(size = 12)
  )
```


